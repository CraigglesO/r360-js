<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>Leaflet vs. Google Maps</title>
    <style>
      html, body {
        height: 100%;
        margin: 0px;
        padding: 0px
      }


      #google-maps-color-map, #google-maps-bw-map {

        width: 50%;
        height: 50%;
        float: left;
      }

      #leaflet-color-map, #leaflet-bw-map {

        width: 50%;
        height: 50%;
        float: left;
      }

    </style>
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet.css" />
    <script src="http://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet-src.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&signed_in=true"></script>
    <script type="text/javascript" src="../../spec/dummydata/transit-polygon.js"></script>
    <script type="text/javascript" src="../../build/deps.js"></script>
    <script type="text/javascript" src="../../build/r360-include.js"></script>
    <script type="text/javascript">

        $(document).ready(function(){

            // var p = r360.CRS.EPSG3857.transformation._transform({ x : 1488218 , y: 6895768  });
            // console.log(p)
            // console.log(r360.CRS.EPSG3857.transformation.untransform(p));

            // var x = r360.Util.webMercatorToLeaflet({ x : 1488218, y: 6895768 });
            // console.log(x)
            // console.log(r360.Util.leafletToWebMercator(x));            

            // console.log(r360.Util.parsePolygons(transitPolygon));

            // function initGoogle() {

            //     var colorMap = new google.maps.Map(document.getElementById('google-maps-color-map'), { 
            //         zoom: 11, center: new google.maps.LatLng(52.5167, 13.3833), mapTypeId: google.maps.MapTypeId.STREETS });
                
            //     var bwMap = new google.maps.Map(document.getElementById('google-maps-bw-map'), { 
            //         zoom: 11, center: new google.maps.LatLng(52.5167, 13.3833), mapTypeId: google.maps.MapTypeId.STREETS });

            //     var colorPolygonLayer = new GoogleMapsPolygonLayer(colorMap);
            //     var bwPolygonLayer    = new GoogleMapsPolygonLayer(bwMap, { inverse : true });
                
            //     google.maps.event.addListenerOnce(colorMap, 'idle', function(){
            //         colorPolygonLayer.update(r360.Util.parsePolygons(transitPolygon));
            //     });

            //     google.maps.event.addListenerOnce(bwMap, 'idle', function(){
            //         bwPolygonLayer.update(r360.Util.parsePolygons(transitPolygon))
            //     });
            // }

            function initLeaflet() {

                var colorMap  = L.map('leaflet-color-map').setView([52.5167, 13.3833], 11);
                var tileLayer = L.tileLayer('https://a.tiles.mapbox.com/v3/mi.0ad4304c/{z}/{x}/{y}.png', {
                    maxZoom: 22, attribution: "Powered by leaflet and openstreetmaps" }).addTo(colorMap);

                var polygonLayer  = r360.leafletPolygonLayer().addTo(colorMap);

                var multiPolygon  = r360.Util.parsePolygons(transitPolygon);
                polygonLayer.clearAndAddLayers(multiPolygon);

                for(var i = 0; i < multiPolygon.length; i++){
                    for(var j = 0; j < multiPolygon[i].polygons.length; j++)
                        console.log(multiPolygon[i].polygons[j].getBoundingBox());
                }

                //colorMap.fitBounds(multiPolygon[1]);

                // var bwMap     = L.map('leaflet-bw-map').setView([52.5167, 13.3833], 11);
                // var tileLayer = L.tileLayer('https://a.tiles.mapbox.com/v3/mi.0ad4304c/{z}/{x}/{y}.png', {
                //     maxZoom: 22, attribution: "Powered by leaflet and openstreetmaps" }).addTo(bwMap);

                //  var polygonLayer1  = r360.leafletPolygonLayer().addTo(bwMap);
                //  polygonLayer1.setInverse(true);
                //  polygonLayer1.clearAndAddLayers(r360.Util.parsePolygons(transitPolygon));
            }

            // initGoogle();
            initLeaflet();
        });
    </script>
  </head>
  <body>
    <div id="google-maps-color-map"></div>
    <div id="google-maps-bw-map"></div>
    <div id="leaflet-color-map"></div>
    <div id="leaflet-bw-map"></div>
  </body>
</html>