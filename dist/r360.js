function expose(){var oldr360=window.r360;r360.noConflict=function(){return window.r360=oldr360,this},window.r360=r360}function GoogleMapsPolygonLayer(map,options){this.map=map,this.id=this.map.getDiv().id,this.inverse=!1,this.topRight={lat:-90,lng:-180},this.bottomLeft={lat:90,lng:180},this.opacity=r360.config.defaultPolygonLayerOptions.opacity,this.strokeWidth=r360.config.defaultPolygonLayerOptions.strokeWidth,this.backgroundColor=r360.config.defaultPolygonLayerOptions.backgroundColor,this.backgroundOpacity=r360.config.defaultPolygonLayerOptions.backgroundOpacity,this.tolerance=r360.config.defaultPolygonLayerOptions.tolerance,this.extendWidthX=r360.config.defaultPolygonLayerOptions.strokeWidth/2,this.extendWidthY=r360.config.defaultPolygonLayerOptions.strokeWidth/2,"undefined"!=typeof options&&("undefined"!=typeof options.opacity&&(this.opacity=options.opacity),"undefined"!=typeof options.strokeWidth&&(this.strokeWidth=options.strokeWidth),"undefined"!=typeof options.inverse&&(this.inverse=options.inverse),"undefined"!=typeof options.tolerance&&(this.tolerance=options.tolerance),"undefined"!=typeof options.extendWidthX&&(this.extendWidthX=options.extendWidthX),"undefined"!=typeof options.extendWidthY&&(this.extendWidthY=options.extendWidthY)),this.element=null,this.setMap(this.map),this.addListener()}var r360={version:"v1.0.1",isUndefined:function(obj){return void 0===obj},has:function(obj,key){return null!=obj&&hasOwnProperty.call(obj,key)},isFunction:function(obj){return"function"==typeof obj||!1},findWhere:function(array,attr){var result=void 0;return array.some(function(elem,index,array){var match=!1;for(var index in attr)match=!(!r360.has(elem,index)||elem[index]!==attr[index]);if(match)return result=elem,!0}),result},filter:function(array,predicate){var results=[];return array.forEach(function(elem,index,array){predicate(elem,index,array)&&results.push(elem)}),results},contains:function(array,item){return array.indexOf(item)>-1},each:function(array,cb){array.forEach(function(elem,index,array){cb(elem,index,array)})},max:function(array,iteratee,context){var value,computed,result=-(1/0),lastComputed=-(1/0);if(null==iteratee||"number"==typeof iteratee&&"arrayect"!=typeof array[0]&&null!=array)for(var i=0,length=array.length;i<length;i++)value=array[i],null!=value&&value>result&&(result=value);else r360.each(array,function(elem,index,array){computed=iteratee(elem,index,array),(computed>lastComputed||computed===-(1/0)&&result===-(1/0))&&(result=elem,lastComputed=computed)});return result},keys:function(obj){if("Object"!=typeof obj)return[];if(Object.keys(obj))return Object.keys(obj);var keys=[];for(var key in obj)r360.has(obj,key)&&keys.push(key);return keys}};"object"==typeof module&&"object"==typeof module.exports?module.exports=r360:"function"==typeof define&&define.amd?define(r360):expose(),Function.prototype.bind||(Function.prototype.bind=function(oThis){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var aArgs=Array.prototype.slice.call(arguments,1),fToBind=this,fNOP=function(){},fBound=function(){return fToBind.apply(this instanceof fNOP&&oThis?this:oThis,aArgs.concat(Array.prototype.slice.call(arguments)))};return fNOP.prototype=this.prototype,fBound.prototype=new fNOP,fBound}),r360.Util={getTimeInSeconds:function(){var now=new Date;return 3600*now.getHours()+60*now.getMinutes()+now.getSeconds()},getHoursAndMinutesInSeconds:function(){var now=new Date;return 3600*now.getHours()+60*now.getMinutes()},getCurrentDate:function(){var date=new Date,year=date.getFullYear(),month=date.getMonth()+1<10?"0"+(date.getMonth()+1):date.getMonth()+1,day=date.getDate()<10?"0"+date.getDate():date.getDate();return year+""+month+day},getTimeFormat:function(seconds){var i18n=r360.config.i18n;return"en"==i18n.language&&seconds>=43200?"p.m.":i18n.get("timeFormat")},secondsToHoursAndMinutes:function(seconds){var minutes=(seconds/60).toFixed(0),hours=Math.floor(minutes/60);minutes-=60*hours;var timeString="";return 0!=hours&&(timeString+=hours+"h "),timeString+=minutes+"min"},secondsToTimeOfDay:function(seconds){var hours=Math.floor(seconds/3600),minutes=Math.floor(seconds/60)-60*hours;return seconds=seconds-3600*hours-60*minutes,hours+":"+("0"+minutes).slice(-2)+":"+("0"+seconds).slice(-2)},generateId:function(length){for(var id="",possible="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=0;i<(length?length:10);i++)id+=possible.charAt(Math.floor(Math.random()*possible.length));return id},parseLatLonArray:function(latlngs){for(var coordinates=new Array,i=0;i<latlngs.length;i++)coordinates.push(new r360.Point(latlngs[i][0],latlngs[i][1]));return coordinates},getAddressByCoordinates:function(latlng,language,callback){$.getJSON(r360.config.nominatimUrl+"reverse.php?&format=json&lat="+latlng.lat+"&accept-language="+language+"&lon="+latlng.lng+"&json_callback=?",callback)},formatReverseGeocoding:function(json){var streetAdress=[];r360.has(json.address,"road")&&streetAdress.push(json.address.road),r360.has(json.address,"house_number")&&streetAdress.push(json.address.house_number);var city=[];r360.has(json.address,"postcode")&&city.push(json.address.postcode),r360.has(json.address,"city")&&city.push(json.address.city);var address=[];return streetAdress.length>0&&address.push(streetAdress.join(" ")),city.length>0&&address.push(city.join(", ")),0==streetAdress.length&&0==city.length&&address.push(json.display_name),address.join(", ")},formatPhotonReverseGeocoding:function(place){var streetAdress=[];r360.has(place,"name")&&streetAdress.push(place.name),r360.has(place,"street")&&streetAdress.push(place.street),r360.has(place,"housenumber")&&streetAdress.push(place.housenumber);var city=[];r360.has(place,"postcode")&&city.push(place.postcode),r360.has(place,"city")&&city.push(place.city);var address=[];return streetAdress.length>0&&address.push(streetAdress.join(" ")),city.length>0&&address.push(city.join(", ")),0==streetAdress.length&&0==city.length&&address.push("Reverse geocoding not possible."),address.join(", ")},parsePolygons:function(polygonsJson){for(var multiPolygon=[],i=0;i<polygonsJson.length;i++)for(var source=polygonsJson[i],j=0;j<source.polygons.length;j++){var polygonJson=source.polygons[j],polygon=r360.polygon(polygonJson.travelTime,polygonJson.area,r360.lineString(r360.Util.parseLatLonArray(polygonJson.outerBoundary))),color=r360.findWhere(r360.config.defaultTravelTimeControlOptions.travelTimes,{time:polygon.getTravelTime()});polygon.setColor(r360.isUndefined(color)?"#000000":color.color);var opacity=r360.findWhere(r360.config.defaultTravelTimeControlOptions.travelTimes,{time:polygon.getTravelTime()});if(polygon.setOpacity(r360.isUndefined(opacity)?1:opacity.opacity),"undefined"!=typeof polygonJson.innerBoundary)for(var k=0;k<polygonJson.innerBoundary.length;k++)polygon.addInnerBoundary(r360.lineString(r360.Util.parseLatLonArray(polygonJson.innerBoundary[k])));r360.PolygonUtil.addPolygonToMultiPolygon(multiPolygon,polygon)}return multiPolygon.sort(function(a,b){return b.getTravelTime()-a.getTravelTime()}),multiPolygon},parseRoutes:function(json){for(var routes=new Array,i=0;i<json.routes.length;i++){var meta=json.routes[i];routes.push(r360.route(json.routes[i].travelTime,json.routes[i].segments,meta))}return routes},webMercatorToLeaflet:function(point){return r360.CRS.EPSG3857.transformation._transform(r360.point(point.x/6378137,point.y/6378137))},webMercatorToLatLng:function(point,elevation){var latlng=r360.CRS.EPSG3857.projection.unproject(new r360.Point(point.x,point.y));return"undefined"!=typeof elevation?r360.latLng([latlng.lat,latlng.lng,elevation]):latlng},latLngToWebMercator:function(latlng){var point=r360.Projection.SphericalMercator.project(latlng);return point.x*=6378137,point.y*=6378137,point},getUserAgent:function(){var tem,ua=navigator.userAgent,M=ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(M[1])?(tem=/\brv[ :]+(\d+)/g.exec(ua)||[],"IE "+(tem[1]||"")):"Chrome"===M[1]&&(tem=ua.match(/\bOPR\/(\d+)/),null!=tem)?"Opera "+tem[1]:(M=M[2]?[M[1],M[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(tem=ua.match(/version\/(\d+)/i))&&M.splice(1,1,tem[1]),M.join(" "))},isAnimated:function(){var userAgent=getUserAgent();return userAgent.indexOf("IE")==-1&&(userAgent.indexOf("Safari")==-1&&(userAgent.indexOf("Firefox")==-1&&!!r360.config.defaultPolygonLayerOptions.animate))},getTranslation:function(offset){var userAgent=r360.Util.getUserAgent();return userAgent.indexOf("IE 9")!=-1?"transform:translate("+offset.x+"px,"+offset.y+"px)":userAgent.indexOf("Safari")!=-1?"-webkit-transform:translate3d("+offset.x+"px,"+offset.y+"px,0px)":userAgent.indexOf("Firefox")!=-1?"-moz-transform:translate3d("+offset.x+"px,"+offset.y+"px,0px)":"transform:translate3d("+offset.x+"px,"+offset.y+"px,0px)"},formatNum:function(num,digits){var pow=Math.pow(10,digits||5);return Math.round(num*pow)/pow},isArray:Array.isArray||function(obj){return"[object Array]"===Object.prototype.toString.call(obj)},extend:function(dest){var i,j,len,src;for(j=1,len=arguments.length;j<len;j++){src=arguments[j];for(i in src)dest[i]=src[i]}return dest}},r360.extend=r360.Util.extend,r360.CRS={latLngToPoint:function(latlng,zoom){var projectedPoint=this.projection.project(latlng),scale=this.scale(zoom);return this.transformation._transform(projectedPoint,scale)},pointToLatLng:function(point,zoom){var scale=this.scale(zoom),untransformedPoint=this.transformation.untransform(point,scale);return this.projection.unproject(untransformedPoint)},project:function(latlng){return this.projection.project(latlng)},unproject:function(point){return this.projection.unproject(point)},scale:function(zoom){return 256*Math.pow(2,zoom)},getProjectedBounds:function(zoom){if(this.infinite)return null;var b=this.projection.bounds,s=this.scale(zoom),min=this.transformation.transform(b.min,s),max=this.transformation.transform(b.max,s);return r360.bounds(min,max)},wrapLatLng:function(latlng){var lng=this.wrapLng?r360.Util.wrapNum(latlng.lng,this.wrapLng,!0):latlng.lng,lat=this.wrapLat?r360.Util.wrapNum(latlng.lat,this.wrapLat,!0):latlng.lat,alt=latlng.alt;return r360.latLng(lat,lng,alt)}},r360.Bounds=function(a,b){if(a)for(var points=b?[a,b]:a,i=0,len=points.length;i<len;i++)this.extend(points[i])},r360.Bounds.prototype={extend:function(point){return point=r360.point(point),this.min||this.max?(this.min.x=Math.min(point.x,this.min.x),this.max.x=Math.max(point.x,this.max.x),this.min.y=Math.min(point.y,this.min.y),this.max.y=Math.max(point.y,this.max.y)):(this.min=point.clone(),this.max=point.clone()),this},getCenter:function(round){return new r360.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,round)},getBottomLeft:function(){return new r360.Point(this.min.x,this.max.y)},getTopRight:function(){return new r360.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(obj){var min,max;return obj="number"==typeof obj[0]||obj instanceof r360.Point?r360.point(obj):r360.bounds(obj),obj instanceof r360.Bounds?(min=obj.min,max=obj.max):min=max=obj,min.x>=this.min.x&&max.x<=this.max.x&&min.y>=this.min.y&&max.y<=this.max.y},intersects:function(bounds){bounds=r360.bounds(bounds);var min=this.min,max=this.max,min2=bounds.min,max2=bounds.max,xIntersects=max2.x>=min.x&&min2.x<=max.x,yIntersects=max2.y>=min.y&&min2.y<=max.y;return xIntersects&&yIntersects},overlaps:function(bounds){bounds=r360.bounds(bounds);var min=this.min,max=this.max,min2=bounds.min,max2=bounds.max,xOverlaps=max2.x>min.x&&min2.x<max.x,yOverlaps=max2.y>min.y&&min2.y<max.y;return xOverlaps&&yOverlaps},isValid:function(){return!(!this.min||!this.max)}},r360.bounds=function(a,b){return!a||a instanceof r360.Bounds?a:new r360.Bounds(a,b)},r360.Point=function(x,y,round){this.x=round?Math.round(x):x,this.y=round?Math.round(y):y},r360.Point.prototype={clone:function(){return new r360.Point(this.x,this.y)},add:function(point){return this.clone()._add(r360.point(point))},_add:function(point){return this.x+=point.x,this.y+=point.y,this},subtract:function(point){return this.clone()._subtract(r360.point(point))},_subtract:function(point){return this.x-=point.x,this.y-=point.y,this},divideBy:function(num){return this.clone()._divideBy(num)},_divideBy:function(num){return this.x/=num,this.y/=num,this},multiplyBy:function(num){return this.clone()._multiplyBy(num)},_multiplyBy:function(num){return this.x*=num,this.y*=num,this},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},distanceTo:function(point){point=r360.point(point);var x=point.x-this.x,y=point.y-this.y;return Math.sqrt(x*x+y*y)},equals:function(point){return point=r360.point(point),point.x===this.x&&point.y===this.y},contains:function(point){return point=r360.point(point),Math.abs(point.x)<=Math.abs(this.x)&&Math.abs(point.y)<=Math.abs(this.y)},toString:function(){return"Point("+r360.Util.formatNum(this.x)+", "+r360.Util.formatNum(this.y)+")"}},r360.point=function(x,y,round){return x instanceof r360.Point?x:r360.Util.isArray(x)?new r360.Point(x[0],x[1]):void 0===x||null===x?x:new r360.Point(x,y,round)},r360.Transformation=function(a,b,c,d){this._a=a,this._b=b,this._c=c,this._d=d},r360.Transformation.prototype={transform:function(point,scale){return this._transform(point.clone(),scale)},_transform:function(point,scale){return scale=scale||1,point.x=scale*(this._a*point.x+this._b),point.y=scale*(this._c*point.y+this._d),point},untransform:function(point,scale){return scale=scale||1,new r360.Point((point.x/scale-this._b)/this._a,(point.y/scale-this._d)/this._c)}},r360.Projection={},r360.Projection.SphericalMercator={R:6378137,project:function(latlng){var d=Math.PI/180,max=1-1e-15,sin=Math.max(Math.min(Math.sin(latlng.lat*d),max),-max);return new r360.Point(this.R*latlng.lng*d,this.R*Math.log((1+sin)/(1-sin))/2)},unproject:function(point){var d=180/Math.PI;return new r360.LatLng((2*Math.atan(Math.exp(point.y/this.R))-Math.PI/2)*d,point.x*d/this.R)},bounds:function(){var d=6378137*Math.PI;return r360.bounds([-d,-d],[d,d])}()},"object"==typeof google&&"object"==typeof google.maps&&(GoogleMapsPolygonLayer.prototype=new google.maps.OverlayView,GoogleMapsPolygonLayer.prototype.onAdd=function(){this.element=document.createElement("div"),this.element.id="r360-googlemaps-polygon-layer-canvas-in-"+this.id,this.getPanes().overlayLayer.appendChild(this.element)},GoogleMapsPolygonLayer.prototype.getMapPixelBounds=function(){var bottomLeft=r360.GoogleMapsUtil.googleLatlngToPoint(this.map,this.map.getBounds().getSouthWest(),this.map.getZoom()),topRight=r360.GoogleMapsUtil.googleLatlngToPoint(this.map,this.map.getBounds().getNorthEast(),this.map.getZoom());return{max:{x:topRight.x,y:bottomLeft.y},min:{x:bottomLeft.x,y:topRight.y}}},GoogleMapsPolygonLayer.prototype.getPixelOrigin=function(){var viewHalf=r360.PolygonUtil.divide({x:this.map.getDiv().offsetWidth,y:this.map.getDiv().offsetHeight},2),center=r360.GoogleMapsUtil.googleLatlngToPoint(this.map,this.map.getCenter(),this.map.getZoom());return r360.PolygonUtil.roundPoint(r360.PolygonUtil.subtract(center,viewHalf.x,viewHalf.y))},GoogleMapsPolygonLayer.prototype.getBoundingBox3857=function(){return this.multiPolygons[0].getBoundingBox3857()},GoogleMapsPolygonLayer.prototype.getBoundingBox4326=function(){return this.multiPolygons[0].getBoundingBox4326()},GoogleMapsPolygonLayer.prototype.setInverse=function(inverse){this.inverse!=inverse&&(this.inverse=inverse,this.draw())},GoogleMapsPolygonLayer.prototype.createSvgData=function(polygon){var svg=r360.SvgUtil.createSvgData(polygon,{bounds:r360.PolygonUtil.extendBounds(this.getMapPixelBounds(),this.extendWidthX,this.extendWidthY),scale:256*Math.pow(2,this.map.getZoom()),tolerance:this.tolerance,pixelOrigin:this.getPixelOrigin(),offset:{x:0,y:0}});return svg},GoogleMapsPolygonLayer.prototype.setColors=function(colors){if("undefined"!=typeof this.multiPolygons){colors=colors;for(var i=0;i<this.multiPolygons.length;i++){var multipolygon=this.multiPolygons[i];colors.forEach(function(colorSet){colorSet.time==multipolygon.getTravelTime()&&multipolygon.setColor(colorSet.color)})}this.draw()}},GoogleMapsPolygonLayer.prototype.fitMap=function(){var bounds=this.getBoundingBox4326(),sw=bounds.getSouthWest(),ne=bounds.getNorthEast(),gmBounds=new google.maps.LatLngBounds(new google.maps.LatLng(sw.lat,sw.lng),new google.maps.LatLng(ne.lat,ne.lng));this.map.fitBounds(gmBounds)},GoogleMapsPolygonLayer.prototype.draw=function(test){if("undefined"!=typeof this.multiPolygons&&null!=this.element){this.svgWidth=this.map.getDiv().offsetWidth,this.svgHeight=this.map.getDiv().offsetHeight;var svgPosition=$("#svg_"+this.id).offset(),mapPosition=$(this.map.getDiv()).offset();"undefined"==typeof this.offset&&(this.offset={x:0,y:0}),"undefined"!=typeof svgPosition&&(this.offset.x+=mapPosition.left-svgPosition.left,this.offset.y+=mapPosition.top-svgPosition.top),$("#"+this.element.id).empty();for(var gElements=[],i=0;i<this.multiPolygons.length;i++){for(var multiPolygon=this.multiPolygons[i],svgData=[],j=0;j<multiPolygon.polygons.length;j++)svgData.push(this.createSvgData(multiPolygon.polygons[j]));0!=svgData.length&&gElements.push(r360.SvgUtil.getGElement(svgData,{color:this.inverse?"black":multiPolygon.getColor(),opacity:this.inverse?multiPolygon.getOpacity():1,strokeWidth:this.strokeWidth}))}var options={id:this.id,offset:this.offset,svgHeight:this.svgHeight,svgWidth:this.svgWidth,backgroundColor:this.backgroundColor,backgroundOpacity:this.backgroundOpacity,opacity:this.opacity,strokeWidth:this.strokeWidth};$("#"+this.element.id).append(this.inverse?r360.SvgUtil.getInverseSvgElement(gElements,options):r360.SvgUtil.getNormalSvgElement(gElements,options))}},GoogleMapsPolygonLayer.prototype.update=function(multiPolygons){this.multiPolygons=multiPolygons,this.draw()},GoogleMapsPolygonLayer.prototype.addListener=function(){var map=this.map,that=this;google.maps.event.addListener(map,"zoom_changed",function(){that.onRemove(),google.maps.event.addListenerOnce(map,"idle",function(){that.draw()})}),google.maps.event.addListener(map,"dragend",function(){google.maps.event.addListenerOnce(map,"idle",function(){that.draw()})}),google.maps.event.addDomListener(window,"resize",function(){google.maps.event.trigger(map,"resize"),that.draw()})},GoogleMapsPolygonLayer.prototype.onRemove=function(){"undefined"!=typeof this.element&&null!=this.element&&$("#"+this.element.id).empty()},r360.googleMapsPolygonLayer=function(map){if("undefined"==typeof this.element&&null==this.element)return new GoogleMapsPolygonLayer(map)}),r360.GoogleMapsUtil={googleLatlngToPoint:function(map,latlng,z){var normalizedPoint=map.getProjection().fromLatLngToPoint(latlng),scale=Math.pow(2,z);return new google.maps.Point(normalizedPoint.x*scale,normalizedPoint.y*scale)},googlePointToLatlng:function(map,point,z){var scale=Math.pow(2,z),normalizedPoint=new google.maps.Point(point.x/scale,point.y/scale),latlng=map.getProjection().fromPointToLatLng(normalizedPoint);return latlng}},"object"==typeof L&&(CanvasLayer=L.Class.extend({initialize:function(options){"use strict";this.items=[];var that=this;that.mapZoomPowerLookup=[];for(var i=0;i<25;i++)that.mapZoomPowerLookup[i]=256*Math.pow(2,i)},getItemBelowCursor:function(items,event){var that=this;for(i=0;i<items.length;i++)if(that.containedByCanvas(items[i].currentPixel)&&that.containedByIcon(items[i],event))return items[i];return null},containedByCanvas:function(pixel){return pixel.x>=0&&pixel.x<=this.canvasWidth&&pixel.y>=0&&pixel.y<=this.canvasHeight},containedByIcon:function(item,event){var newPageX=event.pageX-this.mapPosition.left,newPageY=event.pageY-this.mapPosition.top,diffX=newPageX-item.currentPixel.x,diffY=newPageY-item.currentPixel.y,ringSizes=this.getRingSizesByZoom(item.icon,this.map._zoom);return diffX>-ringSizes.outerRing&&diffY>-ringSizes.outerRing&&diffX<ringSizes.outerRing+12&&diffY<ringSizes.outerRing+12},getBoundingBox3857:function(){},getBoundingBox4326:function(){},onAdd:function(map){var that=this;that.map=map,that.id=$(that.map._container).attr("id")+"_"+r360.Util.generateId(),that.elementId="r360-leaflet-canvas-poi-layer-"+that.id+" leaflet-zoom-hide",that.poiCanvasId="poi-canvas"+that.id,that.poiMarkerClickId="poi_marker_click_"+that.id,that.poiMarkerHoverId="poi_marker_hover_"+that.id,that.markerMainCanvasId="canvas_"+that.id,that.element=L.DomUtil.create("div",that.elementId),$(that.element).attr("id",that.poiCanvasId),that.map.getPanes().overlayPane.appendChild(that.element),that.map.on("moveend",that.redraw,that),$("#"+$(that.map._container).attr("id")).on("mousemove",function(event){that.clearMarkerHover(),$(".leaflet-overlay-pane").attr("style","cursor: move; cursor: grab; cursor:-moz-grab; cursor:-webkit-grab;");var item=that.getItemBelowCursor(that.items,event);null!==item&&(item.onHover(),$(".leaflet-overlay-pane").css("cursor","pointer"),that.drawMarkerHover(item))}),$("#"+$(that.map._container).attr("id")).on("click",function(event){that.clearMarkerHover();var item=that.getItemBelowCursor(that.items,event);null!==item&&(item.onClick(),that.drawMarkerClick(item))}),that.resetCanvas()},fitMap:function(options){var bounds=this.getBoundingBox4326(),sw=bounds.getSouthWest(),ne=bounds.getNorthEast();this.map.fitBounds(L.latLngBounds(L.latLng({lat:sw.lat,lng:sw.lng}),L.latLng({lat:ne.lat,lng:ne.lng})),options)},clearAndAddLayers:function(multiPolygons,fitMap,options){return this.clearLayers(),this},addItem:function(item){this.items.push(item),item.coordinate=r360.Util.webMercatorToLeaflet(item.point),this.draw(item)},addLatLngItem:function(item){var p=r360.Util.latLngToWebMercator(item.point);return p.x/=6378137,p.y/=6378137,this.items.push(item),item.coordinate=r360.Util.webMercatorToLeaflet(p),this.draw(item),item},addLayer:function(poiSet){this.poiSet=poiSet;this.draw()},addTo:function(map){return map.addLayer(this),this},onRemove:function(map){map.getPanes().overlayPane.removeChild(this.element),map.off("viewreset",this.draw,this)},getMapPixelBounds:function(){var bounds=this.map.getPixelBounds();return{max:{x:bounds.max.x,y:bounds.max.y},min:{x:bounds.min.x,y:bounds.min.y}}},clearLayers:function(){this.multiPolygons=void 0,$("#poi-canvas"+$(this.map._container).attr("id")).empty()},getRingSizesByZoom:function(icon,zoomLevel){var ringSizes={};return icon.sizes.forEach(function(size){zoomLevel<=size.toZoom&&zoomLevel>=size.fromZoom&&(ringSizes.outerRing=size.outerRing,ringSizes.innerRing=size.innerRing)}),ringSizes},drawRingIcon:function(ctx,icon,pixel){var ringSizes=this.getRingSizesByZoom(icon,this.map._zoom);ctx.beginPath(),ctx.arc(pixel.x,pixel.y,ringSizes.outerRing,0,2*Math.PI,!1),ctx.fillStyle=icon.strokeStyle,ctx.fill(),ctx.beginPath(),ctx.arc(pixel.x,pixel.y,ringSizes.innerRing,0,2*Math.PI,!1),ctx.fillStyle=icon.fillStyle,ctx.fill()},drawMarkerHover:function(item){var c=document.getElementById(this.poiMarkerHoverId),ctx=c.getContext("2d");ctx.clearRect(0,0,this.canvasWidth,this.canvasHeight),this.drawRingIcon(ctx,item.hoverIcon,item.currentPixel)},drawMarkerClick:function(item){var c=document.getElementById(this.poiMarkerClickId),ctx=c.getContext("2d");ctx.clearRect(0,0,this.canvasWidth,this.canvasHeight),this.drawRingIcon(ctx,item.clickIcon,item.currentPixel)},clearMarkerHover:function(){var c=document.getElementById(this.poiMarkerHoverId),ctx=c.getContext("2d");ctx.clearRect(0,0,this.canvasWidth,this.canvasHeight)},clearMarkerClick:function(){var c=document.getElementById(this.poiMarkerClickId),ctx=c.getContext("2d");ctx.clearRect(0,0,this.canvasWidth,this.canvasHeight)},getCanvas:function(width,height,zIndex,id){var canvas='<canvas id="'+id+'" width="'+width+'" height="'+height+'" style="position:absolute; top:0px; left:0px; z-index: '+zIndex+';"></canvas>';return canvas},draw:function(item){var point=r360.PolygonUtil.scale(item.coordinate,this.mapZoomPowerLookup[this.map._zoom]),pixel={x:parseInt(point.x-this.origin.x-this.offset.x),y:parseInt(point.y-this.origin.y-this.offset.y)};item.currentPixel=pixel,this.containedByCanvas(pixel)&&this.arr[pixel.x+";"+pixel.y]!==!0&&(this.drawRingIcon(this.mainMarcerCanvasCtx,item.icon,pixel),this.arr[pixel.x+";"+pixel.y]=!0)},updateOffset:function(){var canvasPosition=$("#canvas_div_"+this.id).offset();this.mapPosition=$(this.map._container).offset(),"undefined"==typeof this.offset&&(this.offset={x:0,y:0}),canvasPosition&&(this.offset.x+=this.mapPosition.left-canvasPosition.left,this.offset.y+=this.mapPosition.top-canvasPosition.top)},resetCanvas:function(){var that=this;this.canvasWidth=this.map.getSize().x,this.canvasHeight=this.map.getSize().y,this.updateOffset(),$("#"+this.poiCanvasId).empty();var translation=r360.Util.getTranslation(this.offset),markerClickCanvas=this.getCanvas(this.canvasWidth,this.canvasHeight,20,this.poiMarkerClickId),markerHoverCanvas=this.getCanvas(this.canvasWidth,this.canvasHeight,10,this.poiMarkerHoverId),markerMainCanvas=this.getCanvas(this.canvasWidth,this.canvasHeight,0,this.markerMainCanvasId),canvas_div_id="canvas_div_"+that.id;$("#"+this.poiCanvasId).append("<div id="+canvas_div_id+' style="'+translation+'">'+markerClickCanvas+markerHoverCanvas+markerMainCanvas+"</div>"),this.updateOffset(),c=document.getElementById(this.markerMainCanvasId),null!==c&&(this.mainMarcerCanvasCtx=c.getContext("2d")),this.arr=[],this.origin=this.map.getPixelOrigin()},redraw:function(){that=this,that.resetCanvas(),that.items.forEach(function(item){that.draw(item)})}})),"object"==typeof L&&(r360.LeafletPolygonLayer=L.Class.extend({initialize:function(options){this.opacity=.4,this.strokeWidth=30,this.tolerance=15,this.extendWidthX=this.strokeWidth/2,this.extendWidthY=this.strokeWidth/2,this.backgroundColor="#000000",this.backgroundOpacity=.5,this.colors=[{time:300,color:"#006837",opacity:.1},{time:600,color:"#39B54A",opacity:.2},{time:900,color:"#8CC63F",opacity:.3},{time:1200,color:"#F7931E",opacity:.4},{time:1500,color:"#F15A24",opacity:.5},{time:1800,color:"#C1272D",opacity:1}],"undefined"!=typeof options&&("undefined"!=typeof options.colors&&(this.colors=options.colors),"undefined"!=typeof options.opacity&&(this.opacity=options.opacity),"undefined"!=typeof options.strokeWidth&&(this.strokeWidth=options.strokeWidth),"undefined"!=typeof options.inverse&&(this.inverse=options.inverse),"undefined"!=typeof options.tolerance&&(this.tolerance=options.tolerance),"undefined"!=typeof options.extendWidthX&&(this.extendWidthX=options.extendWidthX),"undefined"!=typeof options.extendWidthY&&(this.extendWidthY=options.extendWidthY))},setInverse:function(inverse){this.inverse=inverse},getInverse:function(){return this.inverse},getBoundingBox3857:function(){return this.multiPolygons[0].getBoundingBox3857()},getBoundingBox4326:function(){return this.multiPolygons[0].getBoundingBox4326()},onAdd:function(map){this.map=map,this.id=r360.Util.generateId(),this.element=L.DomUtil.create("div","r360-leaflet-polygon-layer-"+$(map._container).attr("id")+"-"+this.id+" leaflet-zoom-hide"),$(this.element).attr("id","canvas"+$(this.map._container).attr("id")+"-"+this.id),this.map.getPanes().overlayPane.appendChild(this.element),this.map.on("moveend",this.draw,this),this.draw()},fitMap:function(options){var bounds=this.getBoundingBox4326(),sw=bounds.getSouthWest(),ne=bounds.getNorthEast();this.map.fitBounds(L.latLngBounds(L.latLng({lat:sw.lat,lng:sw.lng}),L.latLng({lat:ne.lat,lng:ne.lng})),options)},clearAndAddLayers:function(multiPolygons,fitMap,options){return this.clearLayers(),this.addLayer(multiPolygons),"undefined"!=typeof fitMap&&fitMap===!0&&this.fitMap(options),options&&options.callback&&"function"==typeof options.callback&&this.map.addOneTimeEventListener("moveend",function(){options.callback()}),this},addLayer:function(multiPolygons){this.multiPolygons=multiPolygons,this.draw()},addTo:function(map){return map.addLayer(this),this},onRemove:function(map){map.getPanes().overlayPane.removeChild(this.element),map.off("viewreset",this.draw,this)},createSvgData:function(polygon){var bounds=r360.PolygonUtil.extendBounds(this.getMapPixelBounds(),this.extendWidthX,this.extendWidthY);return r360.SvgUtil.createSvgData(polygon,{bounds:bounds,scale:256*Math.pow(2,this.map._zoom),tolerance:this.tolerance,pixelOrigin:this.map.getPixelOrigin(),offset:this.offset})},getMapPixelBounds:function(){var bounds=this.map.getPixelBounds();return{max:{x:bounds.max.x,y:bounds.max.y},min:{x:bounds.min.x,y:bounds.min.y}}},clearLayers:function(){this.multiPolygons=void 0,$("#canvas"+$(this.map._container).attr("id")+"-"+this.id).empty()},setStrokeWidth:function(strokeWidth){this.strokeWidth=strokeWidth},setColors:function(colors){if(this.colors=colors,"undefined"!=typeof this.multiPolygons){for(var i=0;i<this.multiPolygons.length;i++){var multipolygon=this.multiPolygons[i];this.colors.forEach(function(colorSet){colorSet.time==multipolygon.getTravelTime()&&(multipolygon.setColor(colorSet.color),multipolygon.setOpacity(colorSet.opacity))})}this.draw()}},draw:function(){if("undefined"!=typeof this.multiPolygons){this.extendWidthX=1.8*this.map.getSize().x-this.map.getSize().x,this.extendWidthY=1.8*this.map.getSize().y-this.map.getSize().y,this.svgWidth=this.map.getSize().x+this.extendWidthX,this.svgHeight=this.map.getSize().y+this.extendWidthY;var svgPosition=$("#svg_"+$(this.map._container).attr("id")+"-"+this.id).offset(),mapPosition=$(this.map._container).offset();"undefined"==typeof this.offset&&(this.offset={x:0,y:0}),svgPosition&&(this.offset.x+=mapPosition.left-svgPosition.left-this.extendWidthX/2,this.offset.y+=mapPosition.top-svgPosition.top-this.extendWidthY/2),$("#canvas"+$(this.map._container).attr("id")+"-"+this.id).empty();for(var gElements=[],i=0;i<this.multiPolygons.length;i++){for(var multiPolygon=this.multiPolygons[i],svgData=[],j=0;j<multiPolygon.polygons.length;j++)svgData.push(this.createSvgData(multiPolygon.polygons[j]));0!=svgData.length&&gElements.push(r360.SvgUtil.getGElement(svgData,{color:this.inverse?"black":this.getColor(multiPolygon),opacity:this.inverse?this.getOpacity(multiPolygon):1,strokeWidth:this.strokeWidth}))}var options={id:$(this.map._container).attr("id")+"-"+this.id,offset:this.offset,svgHeight:this.svgHeight,svgWidth:this.svgWidth,backgroundColor:this.backgroundColor,backgroundOpacity:this.backgroundOpacity,opacity:this.opacity,strokeWidth:this.strokeWidth};$("#canvas"+$(this.map._container).attr("id")+"-"+this.id).append(this.inverse?r360.SvgUtil.getInverseSvgElement(gElements,options):r360.SvgUtil.getNormalSvgElement(gElements,options))}},getColor:function(multiPolygon){var color="#000000";return this.colors.forEach(function(colorSet){colorSet.time==multiPolygon.getTravelTime()&&r360.has(colorSet,"color")&&(color=colorSet.color)}),color},getOpacity:function(multiPolygon){var opacity=1;return this.colors.forEach(function(colorSet){colorSet.time==multiPolygon.getTravelTime()&&r360.has(colorSet,"opacity")&&(opacity=colorSet.opacity)}),opacity},_layerAdd:function(options){this.onAdd(options.target)}}),r360.leafletPolygonLayer=function(options){return new r360.LeafletPolygonLayer(options)}),r360.LeafletUtil={getMarker:function(latlng,options){var color=r360.has(options,"color")?"-"+options.color:"-blue";return options.icon=L.icon({iconSize:[25,41],iconUrl:options.iconPath+"marker-icon"+color+".png",iconAnchor:[12,41],shadowSize:[41,41],shadowUrl:options.iconPath+"marker-shadow.png",shadowAnchor:[41/3,41],popupAnchor:[0,-35]}),L.marker(latlng,options)},fadeIn:function(layer,route,drawingTime,fadingType,options,onClick){function fadePathSegment(z){segment=route.routeSegments[z],percent="travelTime"==fadingType?segment.getTravelTime()/route.getTravelTime():segment.getDistance()/route.getDistance(),
timeToDraw=percent*drawingTime,"TRANSFER"!=segment.getType()?fader(segment,timeToDraw,options,z):(("undefined"==typeof options||options.paintTransfer||"undefined"!=typeof options&&!r360.has(options,"paintTransfer"))&&addTransferSegment(segment,options),++z<route.routeSegments.length&&fadePathSegment(z))}function addTransferSegment(segment,options){addCircularMarker(segment.points[0],segment,options),segment.points.length>1&&segment.points[0].lat!=segment.points[1].lat&&segment.points[0].lng!=segment.points[1].lng&&addCircularMarker(segment.points[1],segment,options)}function addCircularMarker(latLng,segment,options){var marker=L.circleMarker(latLng,{color:!r360.isUndefined(options)&&r360.has(options,"transferColor")?options.transferColor:segment.getColor(),fillColor:!r360.isUndefined(options)&&r360.has(options,"transferHaloColor")?options.transferHaloColor:"undefined"!=typeof segment.getHaloColor()?segment.getHaloColor():"#9D9D9D",fillOpacity:!r360.isUndefined(options)&&r360.has(options,"transferFillOpacity")?options.transferFillOpacity:1,opacity:!r360.isUndefined(options)&&r360.has(options,"transferOpacity")?options.transferOpacity:1,stroke:!(!r360.isUndefined(options)&&r360.has(options,"transferStroke"))||options.transferStroke,weight:!r360.isUndefined(options)&&r360.has(options,"transferWeight")?options.transferWeight:4,radius:!r360.isUndefined(options)&&r360.has(options,"transferRadius")?options.transferRadius:8}),popup=!r360.isUndefined(options)&&r360.has(options,"popup")?options.popup:"INSERT_TEXT";if("undefined"!=typeof segment){var variable=r360.contains(["walk","transit","source","target","bike","car"],segment.startname)?"":segment.startname;variable=""!=variable||r360.contains(["walk","transit","source","target","bike","car"],segment.endname)?variable:segment.endname,popup=popup.replace("INSERT_TEXT",variable)}!r360.isUndefined(options)&&r360.has(options,"popup")&&(marker.bindPopup(popup),marker.on("mouseover",function(){marker.openPopup()})),marker.addTo(layer),marker.bringToFront()}function fader(segment,millis,options,z){var polylineOptions={};polylineOptions.color=!r360.isUndefined(options)&&r360.has(options,"color")?options.color:segment.getColor(),polylineOptions.opacity=!r360.isUndefined(options)&&r360.has(options,"opacity")?options.opacity:.8,polylineOptions.weight=!r360.isUndefined(options)&&r360.has(options,"weight")?options.weight:5,"TRANSIT"!=segment.getType()&&"WALK"==segment.getType()&&(polylineOptions.color=!r360.isUndefined(options)&&r360.has(options,"walkColor")?options.walkColor:"#006F35",polylineOptions.weight=!r360.isUndefined(options)&&r360.has(options,"walkWeight")?options.walkWeight:7,polylineOptions.dashArray=!r360.isUndefined(options)&&r360.has(options,"walkDashArray")?options.walkDashArray:"1, 10");var polylineHaloOptions={};polylineHaloOptions.weight=!r360.isUndefined(options)&&r360.has(options,"haloWeight")?options.haloWeight:10,polylineHaloOptions.opacity=!r360.isUndefined(options)&&r360.has(options,"haloOpacity")?options.haloOpacity:.7,polylineHaloOptions.color=!r360.isUndefined(options)&&r360.has(options,"haloColor")?options.haloColor:"undefined"!=typeof segment.getHaloColor()?segment.getHaloColor():"#9D9D9D";var pieces=millis/15,choppedLine=chopLineString(segment.getPoints(),pieces),haloLine=L.polyline(choppedLine[0],polylineHaloOptions).addTo(layer),polyLine=L.polyline(choppedLine[0],polylineOptions).addTo(layer);haloLine.on("click",onClick),polyLine.on("click",onClick),fadeLine(polyLine,haloLine,choppedLine,1,z)}function fadeLine(polyLine,haloLine,choppedLine,i,z){for(var latlngs=polyLine.getLatLngs(),j=0;j<choppedLine[i].length;j++)latlngs.push(choppedLine[i][j]);0!=latlngs.length&&(haloLine.setLatLngs(latlngs),polyLine.setLatLngs(latlngs)),++i<choppedLine.length?setTimeout(function(){fadeLine(polyLine,haloLine,choppedLine,i,z)},15):++z<route.routeSegments.length&&fadePathSegment(z)}function chopLineString(latlngs,pieces){for(var segmentDistance,segmentPercent,length=0,steps=1/pieces,percentSoFar=0,newLatLngs=new Array,i=1;i<latlngs.length;i++)length+=latlngs[i-1].distanceTo(latlngs[i]);for(var part=new Array,i=0;i<latlngs.length-1;i++)if(part.push(latlngs[i]),segmentDistance=latlngs[i].distanceTo(latlngs[i+1]),segmentPercent=segmentDistance/length,percentSoFar+=segmentPercent,percentSoFar>=steps)for(;percentSoFar>=steps;)percent=(steps-(percentSoFar-segmentPercent))/segmentPercent,part.push(interpolatePoint(latlngs[i],latlngs[i+1],percent)),steps+=1/pieces,newLatLngs.push(part),part=new Array;return newLatLngs.push(part),part=new Array,part.push(latlngs[latlngs.length-1]),newLatLngs.push(part),newLatLngs}function interpolatePoint(latlng1,latlng2,percent){var tempmap;tempmap="undefined"!=typeof layer.project?layer:layer._map;var p1=tempmap.project(latlng1),p2=tempmap.project(latlng2),xNew=(p2.x-p1.x)*percent+p1.x,yNew=(p2.y-p1.y)*percent+p1.y,newPoint=new r360.point(xNew,yNew),latlng=tempmap.unproject(L.point(newPoint.x,newPoint.y));return latlng}"undefined"==typeof drawingTime&&(drawingTime=0),"undefined"==typeof fadingType&&(fadingType="travelTime"),fadePathSegment(0)}},r360.CRS.Earth=r360.extend({},r360.CRS,{wrapLng:[-180,180],R:6378137,distance:function(latlng1,latlng2){var rad=Math.PI/180,lat1=latlng1.lat*rad,lat2=latlng2.lat*rad,a=Math.sin(lat1)*Math.sin(lat2)+Math.cos(lat1)*Math.cos(lat2)*Math.cos((latlng2.lng-latlng1.lng)*rad);return this.R*Math.acos(Math.min(a,1))}}),r360.CRS.EPSG3857=r360.extend({},r360.CRS.Earth,{code:"EPSG:3857",projection:r360.Projection.SphericalMercator,transformation:function(){var scale=.5/Math.PI;return new r360.Transformation(scale,.5,-scale,.5)}()}),r360.CRS.EPSG900913=r360.extend({},r360.CRS.EPSG3857,{code:"EPSG:900913"}),r360.LatLngBounds=function(southWest,northEast){if(southWest)for(var latlngs=northEast?[southWest,northEast]:southWest,i=0,len=latlngs.length;i<len;i++)this.extend(latlngs[i])},r360.LatLngBounds.prototype={extend:function(obj){var sw2,ne2,sw=this._southWest,ne=this._northEast;if(obj instanceof r360.LatLng)sw2=obj,ne2=obj;else{if(!(obj instanceof r360.LatLngBounds))return obj?this.extend(r360.latLng(obj)||r360.latLngBounds(obj)):this;if(sw2=obj._southWest,ne2=obj._northEast,!sw2||!ne2)return this}return sw||ne?(sw.lat=Math.min(sw2.lat,sw.lat),sw.lng=Math.min(sw2.lng,sw.lng),ne.lat=Math.max(ne2.lat,ne.lat),ne.lng=Math.max(ne2.lng,ne.lng)):(this._southWest=new r360.LatLng(sw2.lat,sw2.lng),this._northEast=new r360.LatLng(ne2.lat,ne2.lng)),this},pad:function(bufferRatio){var sw=this._southWest,ne=this._northEast,heightBuffer=Math.abs(sw.lat-ne.lat)*bufferRatio,widthBuffer=Math.abs(sw.lng-ne.lng)*bufferRatio;return new r360.LatLngBounds(new r360.LatLng(sw.lat-heightBuffer,sw.lng-widthBuffer),new r360.LatLng(ne.lat+heightBuffer,ne.lng+widthBuffer))},getCenter:function(){return new r360.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new r360.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new r360.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(obj){obj="number"==typeof obj[0]||obj instanceof r360.LatLng?r360.latLng(obj):r360.latLngBounds(obj);var sw2,ne2,sw=this._southWest,ne=this._northEast;return obj instanceof r360.LatLngBounds?(sw2=obj.getSouthWest(),ne2=obj.getNorthEast()):sw2=ne2=obj,sw2.lat>=sw.lat&&ne2.lat<=ne.lat&&sw2.lng>=sw.lng&&ne2.lng<=ne.lng},intersects:function(bounds){bounds=r360.latLngBounds(bounds);var sw=this._southWest,ne=this._northEast,sw2=bounds.getSouthWest(),ne2=bounds.getNorthEast(),latIntersects=ne2.lat>=sw.lat&&sw2.lat<=ne.lat,lngIntersects=ne2.lng>=sw.lng&&sw2.lng<=ne.lng;return latIntersects&&lngIntersects},overlaps:function(bounds){bounds=r360.latLngBounds(bounds);var sw=this._southWest,ne=this._northEast,sw2=bounds.getSouthWest(),ne2=bounds.getNorthEast(),latOverlaps=ne2.lat>sw.lat&&sw2.lat<ne.lat,lngOverlaps=ne2.lng>sw.lng&&sw2.lng<ne.lng;return latOverlaps&&lngOverlaps},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(bounds){return!!bounds&&(bounds=r360.latLngBounds(bounds),this._southWest.equals(bounds.getSouthWest())&&this._northEast.equals(bounds.getNorthEast()))},isValid:function(){return!(!this._southWest||!this._northEast)}},r360.latLngBounds=function(a,b){return!a||a instanceof r360.LatLngBounds?a:new r360.LatLngBounds(a,b)},r360.lineString=function(coordinateArray){return new r360.LineString(coordinateArray)},r360.LineString=function(coordinateArray){this.topRight_3857=new r360.Point(-20026377,-20048967),this.bottomLeft_3857=new r360.Point(20026377,20048967),this.coordinates=[];for(var i=coordinateArray.length-1;i>=0;i--)coordinateArray[i].x>this.topRight_3857.x&&(this.topRight_3857.x=coordinateArray[i].x),coordinateArray[i].y>this.topRight_3857.y&&(this.topRight_3857.y=coordinateArray[i].y),coordinateArray[i].x<this.bottomLeft_3857.x&&(this.bottomLeft_3857.x=coordinateArray[i].x),coordinateArray[i].y<this.bottomLeft_3857.y&&(this.bottomLeft_3857.y=coordinateArray[i].y);for(var i=0;i<coordinateArray.length;i++)this.coordinates.push(r360.Util.webMercatorToLeaflet(coordinateArray[i]));this.getTopRight4326=function(){return r360.Util.webMercatorToLatLng(new r360.Point(this.topRight_3857.x,this.topRight_3857.y))},this.getTopRight3857=function(){return this.topRight_3857},this.getTopRightDecimal=function(){return r360.Util.webMercatorToLeaflet(this.topRight_3857)},this.getBottomLeft4326=function(){return r360.Util.webMercatorToLatLng(new r360.Point(this.bottomLeft_3857.x,this.bottomLeft_3857.y))},this.getBottomLeft3857=function(){return this.bottomLeft_3857},this.getBottomLeftDecimal=function(){return r360.Util.webMercatorToLeaflet(this.bottomLeft_3857)},this.getCoordinates=function(){return this.coordinates},this.getCoordinate=function(index){return this.coordinate[index]}},r360.LatLng=function(lat,lng,alt){if(isNaN(lat)||isNaN(lng))throw new Error("Invalid LatLng object: ("+lat+", "+lng+")");this.lat=+lat,this.lng=+lng,void 0!==alt&&(this.alt=+alt)},r360.LatLng.prototype={equals:function(obj,maxMargin){if(!obj)return!1;obj=r360.latLng(obj);var margin=Math.max(Math.abs(this.lat-obj.lat),Math.abs(this.lng-obj.lng));return margin<=(void 0===maxMargin?1e-9:maxMargin)},toString:function(precision){return"LatLng("+r360.Util.formatNum(this.lat,precision)+", "+r360.Util.formatNum(this.lng,precision)+")"},distanceTo:function(other){return r360.CRS.Earth.distance(this,r360.latLng(other))},wrap:function(){return r360.CRS.Earth.wrapLatLng(this)},toBounds:function(sizeInMeters){var latAccuracy=180*sizeInMeters/40075017,lngAccuracy=latAccuracy/Math.cos(Math.PI/180*this.lat);return r360.latLngBounds([this.lat-latAccuracy,this.lng-lngAccuracy],[this.lat+latAccuracy,this.lng+lngAccuracy])},clone:function(){return new r360.LatLng(this.lat,this.lng,this.alt)}},r360.latLng=function(a,b,c){return a instanceof r360.LatLng?a:r360.Util.isArray(a)&&"object"!=typeof a[0]?3===a.length?new r360.LatLng(a[0],a[1],a[2]):2===a.length?new r360.LatLng(a[0],a[1]):null:void 0===a||null===a?a:"object"==typeof a&&"lat"in a?new r360.LatLng(a.lat,"lng"in a?a.lng:a.lon,a.alt):void 0===b?null:new r360.LatLng(a,b,c)},r360.MultiPolygon=function(){this.travelTime,this.color,this.polygons=new Array,this.topRight_3857=new r360.Point(-20026377,-20048967),this.bottomLeft_3857=new r360.Point(20026377,20048967),this.addPolygon=function(polygon){this.polygons.push(polygon),polygon.getOuterBoundary().getTopRight3857().x>this.topRight_3857.x&&(this.topRight_3857.x=polygon.getOuterBoundary().getTopRight3857().x),polygon.getOuterBoundary().getTopRight3857().y>this.topRight_3857.y&&(this.topRight_3857.y=polygon.getOuterBoundary().getTopRight3857().y),polygon.getOuterBoundary().getBottomLeft3857().x<this.bottomLeft_3857.x&&(this.bottomLeft_3857.x=polygon.getOuterBoundary().getBottomLeft3857().x),polygon.getOuterBoundary().getBottomLeft3857().y<this.bottomLeft_3857.y&&(this.bottomLeft_3857.y=polygon.getOuterBoundary().getBottomLeft3857().y)},this.getBoundingBox3857=function(){return r360.bounds(this.bottomLeft_3857,this.topRight_3857)},this.getBoundingBox4326=function(){return r360.latLngBounds(r360.Util.webMercatorToLatLng(this.bottomLeft_3857),r360.Util.webMercatorToLatLng(this.topRight_3857))},this.setOpacity=function(opacity){this.opacity=opacity},this.getOpacity=function(){return this.opacity},this.getArea=function(){var area=0;return this.polygons.forEach(function(polygon){area+=polygon.getArea()}),area},this.getPolygons=function(){return this.polygons},this.setColor=function(color){this.color=color},this.getColor=function(){return this.color},this.getTravelTime=function(){return this.travelTime},this.setTravelTime=function(travelTime){this.travelTime=travelTime}},r360.multiPolygon=function(){return new r360.MultiPolygon},r360.polygon=function(traveltime,area,outerBoundary){return new r360.Polygon(traveltime,area,outerBoundary)},r360.Polygon=function(traveltime,area,outerBoundary){this.travelTime=traveltime,this.area=area,this.color="black",this.opacity=.5,this.lineStrings=[outerBoundary],this.bounds=void 0,this.setTravelTime=function(travelTime){this.travelTime=travelTime},this.getTravelTime=function(){return this.travelTime},this.getColor=function(){return this.color},this.setColor=function(color){this.color=color},this.setOpacity=function(opacity){this.opacity=opacity},this.getOpacity=function(){return this.opacity},this.getArea=function(){return this.area},this.setArea=function(area){this.area=area},this.getOuterBoundary=function(){return this.lineStrings[0]},this.getInnerBoundary=function(){return this.lineStrings.slice(1)},this.getTopRight4326=function(){return this.getOuterBoundary().getTopRight4326()},this.getTopRight3857=function(){return this.getOuterBoundary().getTopRight3857()},this.getTopRightDecimal=function(){return this.getOuterBoundary().getTopRightDecimal()},this.getBottomLeft4326=function(){return this.getOuterBoundary().getBottomLeft4326()},this.getBottomLeft3857=function(){return this.getOuterBoundary().getBottomLeft3857()},this.getBottomLeftDecimal=function(){return this.getOuterBoundary().getBottomLeftDecimal()},this.addInnerBoundary=function(innerBoundary){this.lineStrings.push(innerBoundary)}},r360.Route=function(travelTime,segments,meta){var that=this;that.travelTime=travelTime,that.routeSegments=[],that.points=[],that.uphillMeter=0,that.downhillMeter=0,that.targetHeight=void 0,that.sourceHeight=void 0,that.sourceId=void 0,that.targetId=void 0,that.length=void 0,that.transfers=0,segments.reverse().forEach(function(segment){var routeSegment=r360.routeSegment(segment);that.routeSegments.push(routeSegment),"TRANSFER"===routeSegment.type&&that.transfers++,that.points=that.points.concat(routeSegment.getPoints().reverse())}),"undefined"!=typeof meta&&(that.sourceId=meta.source_id,that.targetId=meta.target_id,that.length=meta.length),that.equals=function(route){return that.getKey()===route.getKey()},that.getKey=function(){var key=travelTime,points="";return that.getSegments().forEach(function(segment){key+=" "+segment.getRouteShortName()+" "+segment.getDepartureTime()+" "+segment.getArrivalTime(),segment.getPoints().forEach(function(point){points+=" "+point.lat+point.lng})}),key+points},that.addRouteSegment=function(routeSegment){that.routeSegments.push(routeSegment)},that.setTravelTime=function(travelTime){that.travelTime=travelTime},that.getDistance=function(){for(var distance=0,i=0;i<that.routeSegments.length;i++)distance+=that.routeSegments[i].getDistance();return distance},that.getElevationGain=function(){for(var distance=0,i=0;i<that.routeSegments.length;i++)distance+=that.routeSegments[i].getElevationGain();return distance},that.getElevations=function(){for(var elevations={x:[],y:[]},i=0;i<1e3*that.getDistance();i+=100)elevations.x.push(i/1e3+" km"),elevations.y.push(that.getElevationAt(i));return elevations},that.getElevationAt=function(meter){for(var currentLength=0,i=1;i<that.points.length;i++){var previousPoint=that.points[i-1],currentPoint=that.points[i],currentDistance=previousPoint.distanceTo(currentPoint);if(currentLength+=currentDistance,currentLength>meter)return currentPoint.alt}},that.getSegments=function(){return that.routeSegments},that.getUphillElevation=function(){return that.uphillMeter},that.getDownhillElevation=function(){return that.downhillMeter},that.getTotalElevationDifference=function(){return Math.abs(that.sourceHeight-that.targetHeight)},that.setElevationDifferences=function(){for(var previousHeight=void 0,i=that.points.length-1;i>=0;i--)0==i&&(that.targetHeight=that.points[i].alt),i==that.points.length-1&&(that.sourceHeight=that.points[i].alt),"undefined"!=typeof previousHeight&&(previousHeight>that.points[i].alt?that.uphillMeter+=previousHeight-that.points[i].alt:previousHeight<that.points[i].alt&&(that.downhillMeter+=that.points[i].alt-previousHeight)),previousHeight=that.points[i].alt}(),that.getTravelTime=function(){return that.travelTime}},r360.route=function(travelTime,segments,meta){return new r360.Route(travelTime,segments,meta)},r360.RouteSegment=function(segment){var that=this;if(that.points=[],that.type=segment.type,that.travelTime=segment.travelTime,that.distance=segment.length/1e3,that.warning=segment.warning,that.elevationGain=segment.elevationGain,that.errorMessage,that.transitSegment=!1,that.startname=segment.startname,that.endname=segment.endname,segment.points.forEach(function(point){that.points.push(r360.Util.webMercatorToLatLng(new r360.Point(point[1],point[0]),point[2]))}),segment.isTransit){var colorObject=r360.findWhere(r360.config.routeTypes,{routeType:segment.routeType});that.color="undefined"!=typeof colorObject&&r360.has(colorObject,"color")?colorObject.color:"RED",that.haloColor="undefined"!=typeof colorObject&&r360.has(colorObject,"haloColor")?colorObject.haloColor:"WHITE",that.transitSegment=!0,that.routeType=segment.routeType,that.routeShortName=segment.routeShortName,that.startname=segment.startname,that.endname=segment.endname,that.departureTime=segment.departureTime,that.arrivalTime=segment.arrivalTime,that.tripHeadSign=segment.tripHeadSign}else{var colorObject=r360.findWhere(r360.config.routeTypes,{routeType:segment.type});that.color="undefined"!=typeof colorObject&&r360.has(colorObject,"color")?colorObject.color:"RED",that.haloColor="undefined"!=typeof colorObject&&r360.has(colorObject,"haloColor")?colorObject.haloColor:"WHITE"}that.getPoints=function(){return that.points},that.getType=function(){return that.type},that.getHaloColor=function(){return that.haloColor},that.getColor=function(){return that.color},that.getTravelTime=function(){return that.travelTime},that.getDistance=function(){return that.distance},that.getRouteType=function(){return that.routeType},that.getRouteShortName=function(){return that.routeShortName},that.getStartName=function(){return that.startname},that.getEndName=function(){return that.endname},that.getDepartureTime=function(){return that.departureTime},that.getArrivalTime=function(){return that.arrivalTime},that.getTripHeadSign=function(){return that.tripHeadSign},that.getWarning=function(){return that.warning},that.getElevationGain=function(){return that.elevationGain},that.isTransit=function(){return that.transitSegment}},r360.routeSegment=function(segment){return new r360.RouteSegment(segment)},r360.config={serviceVersion:"v1",pathSerializer:"compact",requestTimeout:1e4,maxRoutingTime:3600,bikeSpeed:15,bikeUphill:20,bikeDownhill:-10,walkSpeed:5,walkUphill:10,walkDownhill:0,travelTimes:[300,600,900,1200,1500,1800],travelType:"walk",logging:!1,defaultTravelTimeControlOptions:{travelTimes:[{time:300,color:"#006837",opacity:.1},{time:600,color:"#39B54A",opacity:.2},{time:900,color:"#8CC63F",opacity:.3},{time:1200,color:"#F7931E",opacity:.4},{time:1500,color:"#F15A24",opacity:.5},{time:1800,color:"#C1272D",opacity:1}],position:"topright",label:"travel time",initValue:30},routeTypes:[{routeType:"WALK",color:"red",haloColor:"white"},{routeType:"BIKE",color:"#558D54",haloColor:"white"},{routeType:"CAR",color:"#558D54",haloColor:"white"},{routeType:"TRANSFER",color:"#C1272D",haloColor:"white"},{routeType:102,color:"#006837",haloColor:"white"},{routeType:400,color:"#156ab8",haloColor:"white"},{routeType:900,color:"red",haloColor:"white"},{routeType:700,color:"#A3007C",haloColor:"white"},{routeType:1e3,color:"blue",haloColor:"white"},{routeType:109,color:"#006F35",haloColor:"white"},{routeType:100,color:"red",haloColor:"white"},{routeType:1,color:"red",haloColor:"red"},{routeType:2,color:"blue",haloColor:"blue"},{routeType:3,color:"yellow",haloColor:"yellow"},{routeType:0,color:"green",haloColor:"green"},{routeType:4,color:"orange",haloColor:"orange"},{routeType:5,color:"red",haloColor:"red"},{routeType:6,color:"blue",haloColor:"blue"},{routeType:7,color:"yellow",haloColor:"yellow"}],photonPlaceAutoCompleteOptions:{serviceUrl:"https://service.route360.net/geocode/",position:"topleft",reset:!1,reverse:!1,placeholder:"Select source",maxRows:5,width:300},defaultRadioOptions:{position:"topright"},defaultPolygonLayerOptions:{opacity:.4,strokeWidth:30,tolerance:15,backgroundColor:"black",backgroundOpacity:.5,inverse:!1,animate:!1,animationDuration:1}},r360.OsmService={cache:{},getPoisInBoundingBox:function(boundingBox,tags,successCallback,errorCallback){var data=$.param({tags:tags},!0);"undefined"!=typeof boundingBox&&(data.northEast=boundingBox._northEast.lng+"|"+boundingBox._northEast.lat,data.southWest=boundingBox._southWest.lng+"|"+boundingBox._southWest.lat),r360.has(r360.OsmService.cache,data)?successCallback(r360.OsmService.cache[data]):$.ajax({url:r360.config.osmServiceUrl+"pois/search?callback=?&"+data,timeout:r360.config.requestTimeout,dataType:"json",success:function(result){successCallback(result)},error:function(data){r360.isFunction(errorCallback)&&errorCallback("service-not-available","The travel time polygon service is currently not available, please try again later.")}})}},r360.PolygonService={cache:{},getCfg:function(travelOptions){var cfg={};return cfg.sources=[],r360.isUndefined(travelOptions.isElevationEnabled())||(cfg.elevation=travelOptions.isElevationEnabled()),r360.isUndefined(travelOptions.getReverse())||(cfg.reverse=travelOptions.getReverse()),r360.isUndefined(travelOptions.getEdgeWeight())||(cfg.edgeWeight=travelOptions.getEdgeWeight()),cfg.polygon={},r360.isUndefined(travelOptions.getTravelTimes())||(cfg.polygon.values=travelOptions.getTravelTimes()),r360.isUndefined(travelOptions.getIntersectionMode())||(cfg.polygon.intersectionMode=travelOptions.getIntersectionMode()),r360.isUndefined(travelOptions.getPolygonSerializer())||(cfg.polygon.serializer=travelOptions.getPolygonSerializer()),r360.isUndefined(travelOptions.isPointReductionEnabled())||(cfg.polygon.pointReduction=travelOptions.isPointReductionEnabled()),r360.isUndefined(travelOptions.getMinPolygonHoleSize())||(cfg.polygon.minPolygonHoleSize=travelOptions.getMinPolygonHoleSize()),r360.isUndefined(travelOptions.getSrid())||(cfg.polygon.srid=travelOptions.getSrid()),r360.isUndefined(travelOptions.getSimplifyMeter())||(cfg.polygon.simplify=travelOptions.getSimplifyMeter()),r360.isUndefined(travelOptions.getBufferMeter())||(cfg.polygon.buffer=travelOptions.getBufferMeter()),r360.isUndefined(travelOptions.getQuadrantSegments())||(cfg.polygon.quadrantSegments=travelOptions.getQuadrantSegments()),travelOptions.getSources().forEach(function(source){var src={lat:r360.has(source,"lat")?source.lat:source.getLatLng().lat,lng:r360.has(source,"lon")?source.lon:r360.has(source,"lng")?source.lng:source.getLatLng().lng,id:r360.has(source,"id")?source.id:"",tm:{}},travelType=r360.has(source,"travelType")?source.travelType:travelOptions.getTravelType();src.tm[travelType]={},"transit"!=travelType&&"biketransit"!=travelType||(src.tm[travelType].frame={},r360.isUndefined(travelOptions.getTime())||(src.tm[travelType].frame.time=travelOptions.getTime()),r360.isUndefined(travelOptions.getDate())||(src.tm[travelType].frame.date=travelOptions.getDate()),r360.isUndefined(travelOptions.getFrameDuration())||(src.tm[travelType].frame.duration=travelOptions.getFrameDuration())),"bike"==travelType&&(src.tm.bike={},r360.isUndefined(travelOptions.getBikeSpeed())||(src.tm.bike.speed=travelOptions.getBikeSpeed()),r360.isUndefined(travelOptions.getBikeUphill())||(src.tm.bike.uphill=travelOptions.getBikeUphill()),r360.isUndefined(travelOptions.getBikeDownhill())||(src.tm.bike.downhill=travelOptions.getBikeDownhill())),"walk"==travelType&&(src.tm.walk={},r360.isUndefined(travelOptions.getWalkSpeed())||(src.tm.walk.speed=travelOptions.getWalkSpeed()),r360.isUndefined(travelOptions.getWalkUphill())||(src.tm.walk.uphill=travelOptions.getWalkUphill()),r360.isUndefined(travelOptions.getWalkDownhill())||(src.tm.walk.downhill=travelOptions.getWalkDownhill())),cfg.sources.push(src)}),cfg},getTravelTimePolygons:function(travelOptions,successCallback,errorCallback,method){var cfg=r360.PolygonService.getCfg(travelOptions);if(r360.has(r360.PolygonService.cache,JSON.stringify(cfg)))successCallback(r360.Util.parsePolygons(r360.PolygonService.cache[JSON.stringify(cfg)]));else{var options=r360.PolygonService.getAjaxOptions(travelOptions,cfg,successCallback,errorCallback,"undefined"==typeof method?"GET":method);$.ajax(options)}},getAjaxOptions:function(travelOptions,cfg,successCallback,errorCallback,method){var serviceUrl="undefined"!=typeof travelOptions.getServiceUrl()?travelOptions.getServiceUrl():r360.config.serviceUrl,options={url:serviceUrl+r360.config.serviceVersion+"/polygon?cfg="+encodeURIComponent(JSON.stringify(cfg))+"&cb=?&key="+travelOptions.getServiceKey(),timeout:r360.config.requestTimeout,dataType:"json",type:method,success:function(result){r360.has(result,"data")?"ok"==result.code?(r360.PolygonService.cache[JSON.stringify(cfg)]=result.data,successCallback("geojson"==travelOptions.getPolygonSerializer()?result.data:r360.Util.parsePolygons(result.data))):r360.isFunction(errorCallback)&&errorCallback(result.code,result.message):(r360.PolygonService.cache[JSON.stringify(cfg)]=result,successCallback("geojson"==travelOptions.getPolygonSerializer()?result.data:r360.Util.parsePolygons(result)))},error:function(data){r360.isFunction(errorCallback)&&(403==data.status?errorCallback("not-authorized",data.responseText):errorCallback("service-not-available","The travel time polygon service is currently not available, please try again later."))}};return"POST"==method&&(options.url=serviceUrl+r360.config.serviceVersion+"/polygon_post?key="+travelOptions.getServiceKey(),options.data=JSON.stringify(cfg),options.contentType="application/json",options.async=!1),options}},r360.PopulationService={cache:{},getPopulationStatistics:function(travelOptions,populationStatistics,successCallback,errorCallback){var cfg={};cfg.sources=[],"undefined"!=typeof travelOptions.isElevationEnabled()&&(cfg.elevation=travelOptions.isElevationEnabled()),"undefined"==typeof travelOptions.getTravelTimes()&&"undefined"==typeof travelOptions.getIntersectionMode()||(cfg.polygon={},"undefined"!=typeof travelOptions.getTravelTimes()&&(cfg.polygon.values=travelOptions.getTravelTimes()),"undefined"!=typeof travelOptions.getIntersectionMode()&&(cfg.polygon.intersectionMode=travelOptions.getIntersectionMode())),travelOptions.getSources().forEach(function(source){var src={lat:r360.has(source,"lat")?source.lat:source.getLatLng().lat,lng:r360.has(source,"lon")?source.lon:r360.has(source,"lng")?source.lng:source.getLatLng().lng,id:r360.has(source,"id")?source.id:source.lat+";"+source.lng,tm:{}},travelType=r360.has(source,"travelType")?source.travelType:travelOptions.getTravelType();src.tm[travelType]={},"transit"==travelType&&(src.tm.transit.frame={},r360.isUndefined(travelOptions.getTime())||(src.tm.transit.frame.time=travelOptions.getTime()),r360.isUndefined(travelOptions.getDate())||(src.tm.transit.frame.date=travelOptions.getDate())),"ebike"==travelType&&(src.tm.ebike={},r360.isUndefined(travelOptions.getBikeSpeed())||(src.tm.ebike.speed=travelOptions.getBikeSpeed()),r360.isUndefined(travelOptions.getBikeUphill())||(src.tm.ebike.uphill=travelOptions.getBikeUphill()),r360.isUndefined(travelOptions.getBikeDownhill())||(src.tm.ebike.downhill=travelOptions.getBikeDownhill())),"rentbike"==travelType&&(src.tm.rentbike={},r360.isUndefined(travelOptions.getBikeSpeed())||(src.tm.rentbike.bikespeed=travelOptions.getBikeSpeed()),r360.isUndefined(travelOptions.getBikeUphill())||(src.tm.rentbike.bikeuphill=travelOptions.getBikeUphill()),r360.isUndefined(travelOptions.getBikeDownhill())||(src.tm.rentbike.bikedownhill=travelOptions.getBikeDownhill()),r360.isUndefined(travelOptions.getWalkSpeed())||(src.tm.rentbike.walkspeed=travelOptions.getWalkSpeed()),r360.isUndefined(travelOptions.getWalkUphill())||(src.tm.rentbike.walkuphill=travelOptions.getWalkUphill()),r360.isUndefined(travelOptions.getWalkDownhill())||(src.tm.rentbike.walkdownhill=travelOptions.getWalkDownhill())),"rentandreturnbike"==travelType&&(src.tm.rentandreturnbike={},r360.isUndefined(travelOptions.getBikeSpeed())||(src.tm.rentandreturnbike.bikespeed=travelOptions.getBikeSpeed()),r360.isUndefined(travelOptions.getBikeUphill())||(src.tm.rentandreturnbike.bikeuphill=travelOptions.getBikeUphill()),r360.isUndefined(travelOptions.getBikeDownhill())||(src.tm.rentandreturnbike.bikedownhill=travelOptions.getBikeDownhill()),r360.isUndefined(travelOptions.getWalkSpeed())||(src.tm.rentandreturnbike.walkspeed=travelOptions.getWalkSpeed()),r360.isUndefined(travelOptions.getWalkUphill())||(src.tm.rentandreturnbike.walkuphill=travelOptions.getWalkUphill()),r360.isUndefined(travelOptions.getWalkDownhill())||(src.tm.rentandreturnbike.walkdownhill=travelOptions.getWalkDownhill())),"bike"==travelType&&(src.tm.bike={},r360.isUndefined(travelOptions.getBikeSpeed())||(src.tm.bike.speed=travelOptions.getBikeSpeed()),r360.isUndefined(travelOptions.getBikeUphill())||(src.tm.bike.uphill=travelOptions.getBikeUphill()),r360.isUndefined(travelOptions.getBikeDownhill())||(src.tm.bike.downhill=travelOptions.getBikeDownhill())),"walk"==travelType&&(src.tm.walk={},r360.isUndefined(travelOptions.getWalkSpeed())||(src.tm.walk.speed=travelOptions.getWalkSpeed()),r360.isUndefined(travelOptions.getWalkUphill())||(src.tm.walk.uphill=travelOptions.getWalkUphill()),r360.isUndefined(travelOptions.getWalkDownhill())||(src.tm.walk.downhill=travelOptions.getWalkDownhill())),cfg.sources.push(src)});var statistics=[];r360.each(populationStatistics,function(statistic){statistics.push("statistics="+statistic)}),r360.has(r360.PopulationService.cache,JSON.stringify(cfg)+statistics.join("&"))?(travelOptions.getWaitControl()&&travelOptions.getWaitControl().hide(),successCallback(r360.PopulationService.cache[JSON.stringify(cfg)+statistics.join("&")])):$.ajax({url:travelOptions.getServiceUrl()+r360.config.serviceVersion+"/population?cfg="+encodeURIComponent(JSON.stringify(cfg))+"&cb=?&key="+travelOptions.getServiceKey()+"&"+statistics.join("&"),timeout:r360.config.requestTimeout,dataType:"json",success:function(result){travelOptions.getWaitControl()&&travelOptions.getWaitControl().hide(),r360.has(result,"data")?"ok"==result.code?(r360.PopulationService.cache[JSON.stringify(cfg)+statistics.join("&")]=result.data,successCallback(result.data)):r360.isFunction(errorCallback)&&errorCallback(result.code,result.message):(r360.PopulationService.cache[JSON.stringify(cfg)+statistics.join("&")]=result,successCallback(result))},error:function(data){travelOptions.getWaitControl()&&travelOptions.getWaitControl().hide(),r360.isFunction(errorCallback)&&errorCallback("service-not-available","The population service is currently not available, please try again later.");
}})}},r360.RouteService={cache:{},getCfg:function(travelOptions){var cfg={sources:[],targets:[],pathSerializer:travelOptions.getPathSerializer()};return r360.isUndefined(travelOptions.isElevationEnabled())||(cfg.elevation=travelOptions.isElevationEnabled()),r360.isUndefined(travelOptions.getReverse())||(cfg.reverse=travelOptions.getReverse()),travelOptions.getSources().forEach(function(source){var src={lat:r360.has(source,"lat")?source.lat:source.getLatLng().lat,lng:r360.has(source,"lon")?source.lon:r360.has(source,"lng")?source.lng:source.getLatLng().lng,id:r360.has(source,"id")?source.id:"",tm:{}},travelType=r360.has(source,"travelType")?source.travelType:travelOptions.getTravelType();src.tm[travelType]={},"transit"!=travelType&&"biketransit"!=travelType||(src.tm[travelType].frame={},r360.isUndefined(travelOptions.getTime())||(src.tm[travelType].frame.time=travelOptions.getTime()),r360.isUndefined(travelOptions.getDate())||(src.tm[travelType].frame.date=travelOptions.getDate()),r360.isUndefined(travelOptions.getRecommendations())||(src.tm[travelType].recommendations=travelOptions.getRecommendations()),r360.isUndefined(travelOptions.getFrameDuration())||(src.tm[travelType].frame.duration=travelOptions.getFrameDuration())),"bike"==travelType&&(src.tm.bike={},r360.isUndefined(travelOptions.getBikeSpeed())||(src.tm.bike.speed=travelOptions.getBikeSpeed()),r360.isUndefined(travelOptions.getBikeUphill())||(src.tm.bike.uphill=travelOptions.getBikeUphill()),r360.isUndefined(travelOptions.getBikeDownhill())||(src.tm.bike.downhill=travelOptions.getBikeDownhill())),"walk"==travelType&&(src.tm.walk={},r360.isUndefined(travelOptions.getWalkSpeed())||(src.tm.walk.speed=travelOptions.getWalkSpeed()),r360.isUndefined(travelOptions.getWalkUphill())||(src.tm.walk.uphill=travelOptions.getWalkUphill()),r360.isUndefined(travelOptions.getWalkDownhill())||(src.tm.walk.downhill=travelOptions.getWalkDownhill())),cfg.sources.push(src)}),cfg.targets=[],travelOptions.getTargets().forEach(function(target){cfg.targets.push({lat:r360.has(target,"lat")?target.lat:target.getLatLng().lat,lng:r360.has(target,"lon")?target.lon:r360.has(target,"lng")?target.lng:target.getLatLng().lng,id:r360.has(target,"id")?target.id:""})}),cfg},getRoutes:function(travelOptions,successCallback,errorCallback){var cfg=r360.RouteService.getCfg(travelOptions);r360.has(r360.RouteService.cache,JSON.stringify(cfg))?successCallback(r360.Util.parseRoutes(JSON.parse(JSON.stringify(r360.RouteService.cache[JSON.stringify(cfg)])))):$.ajax({url:travelOptions.getServiceUrl()+r360.config.serviceVersion+"/route?cfg="+encodeURIComponent(JSON.stringify(cfg))+"&cb=?&key="+travelOptions.getServiceKey(),timeout:r360.config.requestTimeout,dataType:"json",success:function(result){r360.has(result,"data")?"ok"==result.code?(r360.RouteService.cache[JSON.stringify(cfg)]=JSON.parse(JSON.stringify(result.data)),successCallback(r360.Util.parseRoutes(result.data))):r360.isFunction(errorCallback)&&errorCallback(result.code,result.message):(r360.RouteService.cache[JSON.stringify(cfg)]=JSON.parse(JSON.stringify(result)),successCallback(r360.Util.parseRoutes(result)))},error:function(data){r360.isFunction(errorCallback)&&(403==data.status?errorCallback("not-authorized",data.responseText):errorCallback("service-not-available","The routing service is currently not available, please try again later."))}})}},r360.TimeService={cache:{},getCfg:function(travelOptions){var cfg={sources:[],targets:[],pathSerializer:travelOptions.getPathSerializer(),maxRoutingTime:travelOptions.getMaxRoutingTime()};return r360.isUndefined(travelOptions.isElevationEnabled())||(cfg.elevation=travelOptions.isElevationEnabled()),r360.isUndefined(travelOptions.getTravelTimes())&&r360.isUndefined(travelOptions.getIntersectionMode())||(cfg.polygon={},r360.isUndefined(travelOptions.getTravelTimes())||(cfg.polygon.values=travelOptions.getTravelTimes()),r360.isUndefined(travelOptions.getIntersectionMode())||(cfg.polygon.intersectionMode=travelOptions.getIntersectionMode()),r360.isUndefined(travelOptions.getMinPolygonHoleSize())||(cfg.polygon.minPolygonHoleSize=travelOptions.getMinPolygonHoleSize())),travelOptions.getSources().forEach(function(source){var src={lat:r360.has(source,"lat")?source.lat:source.getLatLng().lat,lng:r360.has(source,"lon")?source.lon:r360.has(source,"lng")?source.lng:source.getLatLng().lng,id:r360.has(source,"id")?source.id:"",tm:{}};""==src.id&&(src.id=src.lat+";"+src.lng);var travelType=r360.has(source,"travelType")?source.travelType:travelOptions.getTravelType();src.tm[travelType]={},"transit"!=travelType&&"biketransit"!=travelType||(src.tm[travelType].frame={},r360.isUndefined(travelOptions.getTime())||(src.tm[travelType].frame.time=travelOptions.getTime()),r360.isUndefined(travelOptions.getDate())||(src.tm[travelType].frame.date=travelOptions.getDate())),"ebike"==travelType&&(src.tm.ebike={},r360.isUndefined(travelOptions.getBikeSpeed())||(src.tm.ebike.speed=travelOptions.getBikeSpeed()),r360.isUndefined(travelOptions.getBikeUphill())||(src.tm.ebike.uphill=travelOptions.getBikeUphill()),r360.isUndefined(travelOptions.getBikeDownhill())||(src.tm.ebike.downhill=travelOptions.getBikeDownhill())),"rentbike"==travelType&&(src.tm.rentbike={},r360.isUndefined(travelOptions.getBikeSpeed())||(src.tm.rentbike.bikespeed=travelOptions.getBikeSpeed()),r360.isUndefined(travelOptions.getBikeUphill())||(src.tm.rentbike.bikeuphill=travelOptions.getBikeUphill()),r360.isUndefined(travelOptions.getBikeDownhill())||(src.tm.rentbike.bikedownhill=travelOptions.getBikeDownhill()),r360.isUndefined(travelOptions.getWalkSpeed())||(src.tm.rentbike.walkspeed=travelOptions.getWalkSpeed()),r360.isUndefined(travelOptions.getWalkUphill())||(src.tm.rentbike.walkuphill=travelOptions.getWalkUphill()),r360.isUndefined(travelOptions.getWalkDownhill())||(src.tm.rentbike.walkdownhill=travelOptions.getWalkDownhill())),"rentandreturnbike"==travelType&&(src.tm.rentandreturnbike={},r360.isUndefined(travelOptions.getBikeSpeed())||(src.tm.rentandreturnbike.bikespeed=travelOptions.getBikeSpeed()),r360.isUndefined(travelOptions.getBikeUphill())||(src.tm.rentandreturnbike.bikeuphill=travelOptions.getBikeUphill()),r360.isUndefined(travelOptions.getBikeDownhill())||(src.tm.rentandreturnbike.bikedownhill=travelOptions.getBikeDownhill()),r360.isUndefined(travelOptions.getWalkSpeed())||(src.tm.rentandreturnbike.walkspeed=travelOptions.getWalkSpeed()),r360.isUndefined(travelOptions.getWalkUphill())||(src.tm.rentandreturnbike.walkuphill=travelOptions.getWalkUphill()),r360.isUndefined(travelOptions.getWalkDownhill())||(src.tm.rentandreturnbike.walkdownhill=travelOptions.getWalkDownhill())),"bike"==travelType&&(src.tm.bike={},r360.isUndefined(travelOptions.getBikeSpeed())||(src.tm.bike.speed=travelOptions.getBikeSpeed()),r360.isUndefined(travelOptions.getBikeUphill())||(src.tm.bike.uphill=travelOptions.getBikeUphill()),r360.isUndefined(travelOptions.getBikeDownhill())||(src.tm.bike.downhill=travelOptions.getBikeDownhill())),"walk"==travelType&&(src.tm.walk={},r360.isUndefined(travelOptions.getWalkSpeed())||(src.tm.walk.speed=travelOptions.getWalkSpeed()),r360.isUndefined(travelOptions.getWalkUphill())||(src.tm.walk.uphill=travelOptions.getWalkUphill()),r360.isUndefined(travelOptions.getWalkDownhill())||(src.tm.walk.downhill=travelOptions.getWalkDownhill())),cfg.sources.push(src)}),travelOptions.getTargets().forEach(function(target){var target={lat:r360.has(target,"lat")?target.lat:target.getLatLng().lat,lng:r360.has(target,"lon")?target.lon:r360.has(target,"lng")?target.lng:target.getLatLng().lng,id:r360.has(target,"id")?target.id:""};""==target.id&&(target.id=target.lat+";"+target.lng),cfg.targets.push(target)}),cfg},getRouteTime:function(travelOptions,successCallback,errorCallback){var cfg=r360.TimeService.getCfg(travelOptions);r360.has(r360.TimeService.cache,JSON.stringify(cfg))?successCallback(r360.TimeService.cache[JSON.stringify(cfg)]):$.ajax({url:travelOptions.getServiceUrl()+r360.config.serviceVersion+"/time?key="+travelOptions.getServiceKey(),type:"POST",data:JSON.stringify(cfg),contentType:"application/json",timeout:r360.config.requestTimeout,dataType:"json",success:function(result){r360.has(result,"data")?"ok"==result.code?(r360.TimeService.cache[JSON.stringify(cfg)]=result.data,successCallback(result.data)):r360.isFunction(errorCallback)&&errorCallback(result.code,result.message):(r360.TimeService.cache[JSON.stringify(cfg)]=result,successCallback(result))},error:function(data){r360.isFunction(errorCallback)&&(403==data.status?errorCallback("not-authorized",data.responseText):errorCallback("service-not-available","The time service is currently not available, please try again later."))}})}},function(){var ua=navigator.userAgent.toLowerCase(),doc=document.documentElement,ie="ActiveXObject"in window,webkit=ua.indexOf("webkit")!==-1,phantomjs=ua.indexOf("phantom")!==-1,android23=ua.search("android [23]")!==-1,chrome=ua.indexOf("chrome")!==-1,gecko=ua.indexOf("gecko")!==-1&&!webkit&&!window.opera&&!ie,mobile="undefined"!=typeof orientation||ua.indexOf("mobile")!==-1,msPointer=navigator.msPointerEnabled&&navigator.msMaxTouchPoints&&!window.PointerEvent,pointer=window.PointerEvent&&navigator.pointerEnabled&&navigator.maxTouchPoints||msPointer,ie3d=ie&&"transition"in doc.style,webkit3d="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!android23,gecko3d="MozPerspective"in doc.style,opera12="OTransition"in doc.style,touch=!window.L_NO_TOUCH&&!phantomjs&&(pointer||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch);r360.Browser={ie:ie,ielt9:ie&&!document.addEventListener,webkit:webkit,gecko:gecko,android:ua.indexOf("android")!==-1,android23:android23,chrome:chrome,safari:!chrome&&ua.indexOf("safari")!==-1,ie3d:ie3d,webkit3d:webkit3d,gecko3d:gecko3d,opera12:opera12,any3d:!window.L_DISABLE_3D&&(ie3d||webkit3d||gecko3d)&&!opera12&&!phantomjs,mobile:mobile,mobileWebkit:mobile&&webkit,mobileWebkit3d:mobile&&webkit3d,mobileOpera:mobile&&window.opera,mobileGecko:mobile&&gecko,touch:!!touch,msPointer:!!msPointer,pointer:!!pointer,retina:(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1}}(),r360.Class=function(){},r360.Class.extend=function(props){var NewClass=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},parentProto=NewClass.__super__=this.prototype,proto=r360.Util.create(parentProto);proto.constructor=NewClass,NewClass.prototype=proto;for(var i in this)this.hasOwnProperty(i)&&"prototype"!==i&&(NewClass[i]=this[i]);return props.statics&&(r360.extend(NewClass,props.statics),delete props.statics),props.includes&&(r360.Util.extend.apply(null,[proto].concat(props.includes)),delete props.includes),proto.options&&(props.options=r360.Util.extend(r360.Util.create(proto.options),props.options)),r360.extend(proto,props),proto._initHooks=[],proto.callInitHooks=function(){if(!this._initHooksCalled){parentProto.callInitHooks&&parentProto.callInitHooks.call(this),this._initHooksCalled=!0;for(var i=0,len=proto._initHooks.length;i<len;i++)proto._initHooks[i].call(this)}},NewClass},r360.Class.include=function(props){r360.extend(this.prototype,props)},r360.Class.mergeOptions=function(options){r360.extend(this.prototype.options,options)},r360.Class.addInitHook=function(fn){var args=Array.prototype.slice.call(arguments,1),init="function"==typeof fn?fn:function(){this[fn].apply(this,args)};this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(init)},r360.DomUtil={setPosition:function(el,point){r360.Browser.any3d?r360.DomUtil.setTransform(el,point):(el.style.left=point.x+"px",el.style.top=point.y+"px")},setTransform:function(el,offset,scale){var pos=offset||new r360.Point(0,0);el.style[r360.DomUtil.TRANSFORM]="translate3d("+pos.x+"px,"+pos.y+"px,0)"+(scale?" scale("+scale+")":"")},testProp:function(props){for(var style=document.documentElement.style,i=0;i<props.length;i++)if(props[i]in style)return props[i];return!1}},function(){r360.DomUtil.TRANSFORM=r360.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"])}(),r360.PolygonUtil={clip:function(subjectPolygon,clipPolygon){var cp1,cp2,s,e,inside=function(p){return(cp2[0]-cp1[0])*(p[1]-cp1[1])>(cp2[1]-cp1[1])*(p[0]-cp1[0])},intersection=function(){var dc=[cp1[0]-cp2[0],cp1[1]-cp2[1]],dp=[s[0]-e[0],s[1]-e[1]],n1=cp1[0]*cp2[1]-cp1[1]*cp2[0],n2=s[0]*e[1]-s[1]*e[0],n3=1/(dc[0]*dp[1]-dc[1]*dp[0]);return[(n1*dp[0]-n2*dc[0])*n3,(n1*dp[1]-n2*dc[1])*n3]},outputList=subjectPolygon,cp1=clipPolygon[clipPolygon.length-1];for(j in clipPolygon){var cp2=clipPolygon[j],inputList=outputList;outputList=[],s=inputList[inputList.length-1];for(i in inputList){var e=inputList[i];inside(e)?(inside(s)||outputList.push(intersection()),outputList.push(e)):inside(s)&&outputList.push(intersection()),s=e}cp1=cp2}return outputList},isCollinear:function(p1,p2,p3){if(p1.x==p3.x&&p1.y==p3.y)return!1;if(p1.x==p2.x&&p2.x==p3.x)return!0;if(p1.y==p2.y&&p2.y==p3.y)return!0;var val=p1.x*(p2.y-p3.y)+p2.x*(p3.y-p1.y)+p3.x*(p1.y-p2.y);return val<r360.config.defaultPolygonLayerOptions.tolerance&&val>-r360.config.defaultPolygonLayerOptions.tolerance&&p1.x!=p3.x&&p1.y!=p3.y},scale:function(point,scale){return r360.point(point.x*scale,point.y*scale)},subtract:function(point,x,y){return r360.point(point.x-x,point.y-y)},divide:function(point,quotient){return r360.point(point.x/quotient,point.y/quotient)},roundPoint:function(point){return point.x=Math.round(point.x),point.y=Math.round(point.y),point},buildPath:function(point,suffix){return[suffix,Math.round(point.x),Math.round(point.y)]},getEuclidianDistance:function(point1,point2){return Math.sqrt(Math.pow(point1.x-point2.x,2)+Math.pow(point1.y-point2.y,2))},getSvgFrame:function(width,height){return[["M",0,0],["L",width,0],["L",width,height],["L",0,height],["z"]]},extendBounds:function(bounds,extendWidthX,extendWidthY){var extendX=Math.ceil(extendWidthX),extendY=Math.ceil(extendWidthY);return bounds.max.x+=extendX,bounds.min.x-=extendX,bounds.max.y+=extendY,bounds.min.y-=extendY,bounds},addPolygonToMultiPolygon:function(multiPolygons,polygon){var filteredMultiPolygons=r360.filter(multiPolygons,function(multiPolygon){return multiPolygon.getTravelTime()==polygon.travelTime});if(filteredMultiPolygons.length>0)filteredMultiPolygons[0].addPolygon(polygon);else{var multiPolygon=new r360.multiPolygon;multiPolygon.setTravelTime(polygon.travelTime),multiPolygon.addPolygon(polygon),multiPolygon.setColor(polygon.getColor()),multiPolygon.setOpacity(polygon.getOpacity()),multiPolygons.push(multiPolygon)}}},r360.SvgUtil={getGElement:function(svgData,options){var randomId=r360.Util.generateId(),initialOpacity=options.opacity;return"<g id="+randomId+" style='opacity:"+initialOpacity+"'><path style='stroke: "+options.color+"; fill: "+options.color+" ; stroke-opacity: 1; stroke-width: "+options.strokeWidth+"; fill-opacity:1'd='"+svgData.toString().replace(/\,/g," ")+"'/></g>"},getInverseSvgElement:function(gElements,options){var svgFrame=r360.PolygonUtil.getSvgFrame(options.svgWidth,options.svgHeight),svgStart="<div id=svg_"+options.id+" style='"+r360.Util.getTranslation(options.offset)+";''><svg height="+options.svgHeight+" width="+options.svgWidth+" style='fill:"+options.backgroundColor+" ; opacity: "+options.backgroundOpacity+"; stroke-width: "+options.strokeWidth+"; stroke-linejoin:round; stroke-linecap:round; fill-rule: evenodd' xmlns='http://www.w3.org/2000/svg'>",svgEnd="</svg></div>",newSvg="<defs><mask id='mask_"+options.id+"'><path style='fill-opacity:1;stroke: white; fill:white;' d='"+svgFrame.toString().replace(/\,/g," ")+"'/>"+gElements.join("")+"</mask></defs>",frame="<path style='mask: url(#mask_"+options.id+")' d='"+svgFrame.toString().replace(/\,/g," ")+"'/>";return svgStart+frame+newSvg+svgEnd},getNormalSvgElement:function(gElements,options){var svgStart="<div id=svg_"+options.id+" style='"+r360.Util.getTranslation(options.offset)+";''><svg  height="+options.svgHeight+" width="+options.svgWidth+" style='fill:"+options.backgroundColor+" ; opacity: "+options.opacity+"; stroke-linejoin:round; stroke-linecap:round; fill-rule: evenodd' xmlns='http://www.w3.org/2000/svg'>",svgEnd="</svg></div>";return svgStart+gElements.join("")+svgEnd},createSvgData:function(polygon,options){var pathData=[],topRight=r360.PolygonUtil.scale(polygon.getTopRightDecimal(),options.scale),bottomLeft=r360.PolygonUtil.scale(polygon.getBottomLeftDecimal(),options.scale);bottomLeft.x>options.bounds.max.x||topRight.x<options.bounds.min.x||topRight.y>options.bounds.max.y||bottomLeft.y<options.bounds.min.y||r360.SvgUtil.buildSVGPolygon(pathData,polygon.getOuterBoundary().getCoordinates(),options);for(var innerBoundary=polygon.getInnerBoundary(),i=0;i<innerBoundary.length;i++){var topRightInner=r360.PolygonUtil.scale(innerBoundary[i].getTopRightDecimal(),options.scale),bottomLeftInner=r360.PolygonUtil.scale(innerBoundary[i].getBottomLeftDecimal(),options.scale);bottomLeftInner.x>options.bounds.max.x||topRightInner.x<options.bounds.min.x||topRightInner.y>options.bounds.max.y||bottomLeftInner.y<options.bounds.min.y||r360.SvgUtil.buildSVGPolygon(pathData,innerBoundary[i].getCoordinates(),options)}return pathData},buildSVGPolygon:function(pathData,coordinateArray,options){for(var point,point1,point2,isCollinear,euclidianDistance,pointCount=0,boundArray=[[options.bounds.min.x,options.bounds.min.y],[options.bounds.max.x,options.bounds.min.y],[options.bounds.max.x,options.bounds.max.y],[options.bounds.min.x,options.bounds.max.y]],pointsToClip=[],i=0;i<coordinateArray.length;i++)point=r360.PolygonUtil.scale(r360.point(coordinateArray[i].x,coordinateArray[i].y),options.scale),euclidianDistance=i>0?r360.PolygonUtil.getEuclidianDistance(point2,point):options.tolerance,euclidianDistance>=options.tolerance&&(isCollinear=!1,pointCount>2&&(isCollinear=r360.PolygonUtil.isCollinear(point1,point2,point)),isCollinear?(pointsToClip[pointsToClip.length-1][0]=point.x,pointsToClip[pointsToClip.length-1][1]=point.y):(pointsToClip.push([point.x,point.y]),point1=point2,point2=point,pointCount++));for(var lastPoint,clippedArray=r360.PolygonUtil.clip(pointsToClip,boundArray),i=0;i<clippedArray.length;i++)point=r360.PolygonUtil.subtract(r360.point(clippedArray[i][0],clippedArray[i][1]),options.pixelOrigin.x+options.offset.x,options.pixelOrigin.y+options.offset.y),pathData.push(i>0?r360.PolygonUtil.buildPath(point,"L"):r360.PolygonUtil.buildPath(point,"M")),lastPoint=point;return pathData.length>0&&pathData.push(["z"]),pathData}},r360.TravelOptions=function(){this.sources=[],this.targets=[],this.bikeSpeed=void 0,this.bikeUphill=void 0,this.bikeDownhill=void 0,this.walkSpeed=void 0,this.walkUphill=void 0,this.walkDownhill=void 0,this.travelTimes=void 0,this.travelType=void 0,this.elevationEnabled=void 0,this.minPolygonHoleSize=void 0,this.buffer=void 0,this.simplify=void 0,this.srid=void 0,this.quadrantSegments=void 0,this.time=void 0,this.date=void 0,this.frameDuration=void 0,this.reverse=void 0,this.recommendations=void 0,this.intersectionMode=void 0,this.pathSerializer="compact",this.polygonSerializer="json",this.pointReduction=!0,this.maxRoutingTime=void 0,this.serviceUrl=void 0,this.serviceKey=void 0,this.edgeWeight="time",this.getReverse=function(){return this.reverse},this.setReverse=function(reverse){this.reverse=reverse},this.getFrameDuration=function(){return this.frameDuration},this.setFrameDuration=function(frameDuration){this.frameDuration=frameDuration},this.getBufferMeter=function(){return this.buffer},this.setBufferMeter=function(buffer){this.buffer=buffer},this.getSimplifyMeter=function(){return this.simplify},this.setSimplifyMeter=function(simplify){this.simplify=simplify},this.getSrid=function(){return this.srid},this.setSrid=function(srid){this.srid=srid},this.getQuadrantSegments=function(){return this.quadrantSegments},this.setQuadrantSegments=function(quadrantSegments){this.quadrantSegments=quadrantSegments},this.getSources=function(){return this.sources},this.addSource=function(source){this.sources.push(source)},this.addTarget=function(target){this.targets.push(target)},this.getTargets=function(){return this.targets},this.getBikeSpeed=function(){return this.bikeSpeed},this.getBikeUphill=function(){return this.bikeUphill},this.getBikeDownhill=function(){return this.bikeDownhill},this.getWalkSpeed=function(){return this.walkSpeed},this.getWalkUphill=function(){return this.walkUphill},this.getWalkDownhill=function(){return this.walkDownhill},this.getTravelTimes=function(){return this.travelTimes},this.getTravelType=function(){return this.travelType},this.getTime=function(){return this.time},this.getDate=function(){return this.date},this.getPathSerializer=function(){return this.pathSerializer},this.getPolygonSerializer=function(){return this.polygonSerializer},this.getMaxRoutingTime=function(){return this.maxRoutingTime},this.getIntersectionMode=function(){return this.intersectionMode},this.getRecommendations=function(){return this.recommendations},this.getServiceUrl=function(){return this.serviceUrl},this.getServiceKey=function(){return this.serviceKey},this.setServiceKey=function(serviceKey){this.serviceKey=serviceKey},this.setServiceUrl=function(serviceUrl){this.serviceUrl=serviceUrl},this.setRecommendations=function(recommendations){this.recommendations=recommendations},this.setIntersectionMode=function(intersectionMode){this.intersectionMode=intersectionMode},this.setMaxRoutingTime=function(maxRoutingTime){this.maxRoutingTime=maxRoutingTime},this.setPathSerializer=function(pathSerializer){this.pathSerializer=pathSerializer},this.setPolygonSerializer=function(polygonSerializer){this.polygonSerializer=polygonSerializer},this.setMinPolygonHoleSize=function(minPolygonHoleSize){this.minPolygonHoleSize=minPolygonHoleSize},this.getMinPolygonHoleSize=function(){return this.minPolygonHoleSize},this.setSources=function(sources){this.sources=sources},this.setTargets=function(targets){this.targets=targets},this.setBikeSpeed=function(bikeSpeed){this.bikeSpeed=bikeSpeed},this.setBikeUphill=function(bikeUphill){this.bikeUphill=bikeUphill},this.setBikeDownhill=function(bikeDownhill){this.bikeDownhill=bikeDownhill},this.setWalkSpeed=function(walkSpeed){this.walkSpeed=walkSpeed},this.setWalkUphill=function(walkUphill){this.walkUphill=walkUphill},this.setWalkDownhill=function(walkDownhill){this.walkDownhill=walkDownhill},this.setTravelTimes=function(travelTimes){this.travelTimes=travelTimes},this.setTravelType=function(travelType){this.travelType=travelType},this.setTime=function(time){this.time=time},this.setDate=function(date){this.date=date},this.isElevationEnabled=function(){return this.elevationEnabled},this.setElevationEnabled=function(elevationEnabled){this.elevationEnabled=elevationEnabled},this.disablePointReduction=function(){this.pointReduction=!1},this.enablePointReduction=function(){this.pointReduction=!0},this.isPointReductionEnabled=function(){return this.pointReduction},this.getEdgeWeight=function(){return this.edgeWeight},this.setEdgeWeight=function(edgeWeight){this.edgeWeight=edgeWeight}},r360.travelOptions=function(){return new r360.TravelOptions};